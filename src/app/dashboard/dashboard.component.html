<!-- the below commented part is the common template for all the pages which have a side nav -->

<!-- <ng-container>
    <div class="row">
        <div class="sidenav">
        </div>
        <div class="mainArea">           
        </div>
    </div>
</ng-container> -->

<!-- <mat-spinner></mat-spinner> -->
<notifier-container></notifier-container>


<!-- <div class="container-fluid fullPagePagename">
    Insights
</div> -->


<ng-container>
    <div class="row">
        <!-- <div class="sidenav" style="padding-top: -40px;">
            

            <div class="row filterButtonArea" style=" width:100%!important;height: 80%;">
            <div class="col-12 mainMenu" style="background-color: #e8e3ff; color: #ffffff; padding:15px;padding-bottom: 21px; font-size: 12px;">



                    



                    <div class="multiselectFilter" >
                        <ng-multiselect-dropdown [placeholder]="'Month Year'" [settings]="month_dropdownSettings"
                            [data]="month_dropdownList" [(ngModel)]="month_selectedItems"
                            (onSelect)="showMonthFlag=false" (onDeSelect)="showMonthFlag = false" >
                        </ng-multiselect-dropdown>
                    </div>
                    

                    <div class="multiselectFilter">
                        <ng-multiselect-dropdown [placeholder]="'Zone'" [settings]="zone_dropdownSettings"
                            [data]="zone_dropdownList" [(ngModel)]="zone_selectedItems"
                            (onSelect)="get_state_list(); get_location_list()"
                            (onSelectAll)="get_state_list(); get_location_list()"
                            (onDeSelect)="get_state_list(); get_location_list()"
                            (onDeSelectAll)="get_state_list(); get_location_list()">
                        </ng-multiselect-dropdown>
                    </div>

                    <div class="multiselectFilter">
                        <ng-multiselect-dropdown [placeholder]="'State'" [settings]="state_dropdownSettings"
                            [data]="state_dropdownList" [(ngModel)]="state_selectedItems"
                            (onSelect)="get_location_list()" (onSelectAll)="get_location_list()"
                            (onDeSelect)="get_location_list()" (onDeSelectAll)="get_location_list()">
                        </ng-multiselect-dropdown>
                    </div>

                    <div class="multiselectFilter">
                        <ng-multiselect-dropdown [placeholder]="'Location'" [settings]="location_dropdownSettings"
                            [data]="location_dropdownList" [(ngModel)]="location_selectedItems">
                        </ng-multiselect-dropdown>
                    </div>


                   



                    <div class="multiselectFilter">
                        <ng-multiselect-dropdown [placeholder]="'Channel'" [settings]="imdChannel_dropdownSettings"
                            [data]="imdChannel_dropdownList" [(ngModel)]="imdChannel_selectedItems"
                            (onSelect)="get_subChannelList()" (onSelectAll)="get_subChannelList()"
                            (onDeSelect)="get_subChannelList()" (onDeSelectAll)="get_subChannelList()">
                        </ng-multiselect-dropdown>
                    </div>




                    <div class="multiselectFilter">
                        <ng-multiselect-dropdown [placeholder]="'Sub Channel'"
                            [settings]="subChannelCodeName_dropdownSettings" [data]="subChannelCodeName_dropdownList"
                            [(ngModel)]="subChannelCodeName_selectedItems">
                        </ng-multiselect-dropdown>
                    </div>

                    <br>



                    <div class="multiselectFilter" style="display: flex; flex-direction: row; font-size: 18px;">
                            <div class="col-6" style="padding:0">
                                <button class="filterApplyButton" style=" background-color: rgb(238, 99, 99); height: 40px;"
                                    (click)="resetAll();getHeroAgents();getBottomAgents();">
                                    <span>Reset All</span>
                                </button>
            
                            </div>
            
                            <div class="col-6" style="padding:0">
                                <button class="filterApplyButton" style="background-color: rgb(0, 95, 204);  height: 40px;" (click)="filteBtn()
                                 ">
                                    <span>Apply</span>
                                </button>
            
                            </div> 
                    </div>


                    



                </div>


                

            </div>


            



        </div> -->








        







        <!-- <div class="col-12 topNav_filterSection" >

            <div class="row">
                <div class="col"  style=" padding: 10px!important; padding-bottom: 0px!important;">
                    
                        <ng-multiselect-dropdown [placeholder]="'Month Year'" [settings]="month_dropdownSettings"
                            [data]="month_dropdownList" [(ngModel)]="month_selectedItems"
                            (onSelect)="showMonthFlag=false" (onDeSelect)="showMonthFlag = false" >
                        </ng-multiselect-dropdown>
                    
                </div>
    
                <div class="col" style=" padding: 10px!important; padding-bottom: 0px!important; ">
                    
                        <ng-multiselect-dropdown [placeholder]="'Zone'" [settings]="zone_dropdownSettings"
                            [data]="zone_dropdownList" [(ngModel)]="zone_selectedItems"
                            (onSelect)="get_state_list(); get_location_list()"
                            (onSelectAll)="get_state_list(); get_location_list()"
                            (onDeSelect)="get_state_list(); get_location_list()"
                            (onDeSelectAll)="get_state_list(); get_location_list()">
                        </ng-multiselect-dropdown>
                    
                </div>
    
                <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                    
                        <ng-multiselect-dropdown [placeholder]="'State'" [settings]="state_dropdownSettings"
                            [data]="state_dropdownList" [(ngModel)]="state_selectedItems"
                            (onSelect)="get_location_list()" (onSelectAll)="get_location_list()"
                            (onDeSelect)="get_location_list()" (onDeSelectAll)="get_location_list()">
                        </ng-multiselect-dropdown>
                    
                </div>
    
                <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                        <ng-multiselect-dropdown [placeholder]="'Location'" [settings]="location_dropdownSettings"
                            [data]="location_dropdownList" [(ngModel)]="location_selectedItems">
                        </ng-multiselect-dropdown>
                </div>
    
                <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                        <ng-multiselect-dropdown [placeholder]="'Channel'" [settings]="imdChannel_dropdownSettings"
                            [data]="imdChannel_dropdownList" [(ngModel)]="imdChannel_selectedItems"
                            (onSelect)="get_subChannelList()" (onSelectAll)="get_subChannelList()"
                            (onDeSelect)="get_subChannelList()" (onDeSelectAll)="get_subChannelList()">
                        </ng-multiselect-dropdown>
                </div>
    
                <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                    <div class="row" style="padding:0!important; padding-top: 5px!important ">
                        <div class="col-6" style="padding:0">
                            <button class="filterApplyButton" style=" background-color: rgb(238, 99, 99); height: 36px;"
                                (click)="resetAll();getHeroAgents();getBottomAgents();">
                                <span>Reset</span>
                            </button>
        
                        </div>
        
                        <div class="col-6" style="padding:0; ">
                            <button class="filterApplyButton" style="background-color: rgb(0, 95, 204);  height: 36px;" (click)="filteBtn()
                             ">
                                <span>Apply</span>
                            </button>
        
                        </div> 
                    </div>
                </div>
            </div>

        </div> -->




        












        <div class="mainArea">
            <!-- <div class="row " >
                <div class="col-5 agentPad" [ngClass]="agentScoreCard == true ? 'highlightpad':''" (click)="agentScoreCard = true">AGENT SCORE CARD</div>
                <div class="col-7 agentPad" [ngClass]="agentScoreCard == false ? 'highlightpad':''" (click)="agentScoreCard = false">AGENT SEGMENTATION</div>

            </div> -->
            <div class="row mainAreaPad"  style="height: 100%; background-color: #fcfcfc;">

                

                <div class="col-12" style="box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;">
                    <div class="row" style="text-align: center;">
                        <!-- <div class="col-12  " style=" padding:2% ;  overflow: scroll;">
                            <span style="font-weight: bold; font-size: 17px;">Comparison</span>
                            <br><br>

                            <table class="table table-hover" style="text-align: center; justify-items: center;">
                                <thead>
                                    <tr class="" style="background: #bbd4e9;">
                                        <ng-container *ngFor="let col of comparisonColumns">
                                            <th class="tableColumnStyle" style="padding: 0;">{{col}}</th>
                                        </ng-container>
                                    </tr>
                                </thead>

                                <tbody>
                                    <ng-container *ngFor="let rowline of comparisonDetails; let i=index;">
                                        <tr [ngClass]="i%2 == 0? 'highlighRow':''" style="padding: 0;">
                                            <ng-container *ngFor="let col of comparisonColumns">
                                                <td style="padding: 0;" class="tableColumnStyle"
                                                    [ngClass]="(col == 'BANDING')? classDict[rowline[col]]:''">
                                                    {{rowline[col]}}</td>
                                            </ng-container>
                                        </tr>
                                    </ng-container>
                                </tbody>
                            </table>

                        </div> -->
                        <div *ngIf="!sideNav_state" class="col-12" style="font-size: 24px; font-weight: 600; color: #2b76cd; text-align: left;">                    
            
                            Insights
                               
                        </div>
                        <span *ngIf="month_selectedItems.length!=0 && showAsonmonth === true"  style="position:relative!important; left: 50px!important; top: 30px!important; z-index: 99!important; font-size: 14px;">
                            As on: {{month_selectedItems[0].monthName}}  closing
                        </span>

                        <div class="col-12 " style="padding: 30px!important; margin-top: 0px!important;">
                            
                            
                            

                            <div class="row" style="padding:0px!important">


                                <!-- <div class="col-6" style="height: 275px!important">

                                    

                                    <div class="row" style="height:100%; text-align: center; justify-items: center; border-radius: 20px;background-color: #ffffff; padding:40px!important; padding-top:0!important;  border: 1px solid rgb(218, 218, 218); border-radius: 5px;">

                                        <div class="col-12" style="display: flex; justify-content: center; font-size: 18px; font-weight: bold; padding: 10px!important">
                                            Urgent Actionables
                                        </div>

                                        <div class="col-md-12" style="overflow-y: scroll; height: 195px; padding: 0!important; ">
                                            <table class="table table-hover table-striped" style="border-radius: 10px!important;">


                                                
                                                <thead style="position: sticky; top: 0; background: #d7cfff; color:black;">
                                                    <tr class="" style="font-size: 16px!important;">
        
                                                        <th class="tableColumnStyle" style="padding: 10px; ">Sub-Channel</th>
                                                        <th class="tableColumnStyle" style="padding: 10px; ">Priority</th>
                                                        <th class="tableColumnStyle" style="padding: 10px; ">Count</th>
                                                        <th class="tableColumnStyle" style="padding: 10px; ">Concern Area</th>
        
                                                    </tr>
        
                                                </thead>
        
                                                <tbody>
                                                    <ng-container *ngFor="let rowline of urgentActionable_list; let i=index;">
                                                        <tr style="padding: 0; font-size: 16px!important;">
                                                            <td style="padding: 0px; padding-left: 10px;  cursor: pointer; text-align: left;" class="tableColumnStyle">{{rowline.SUB_CHANNEL | titlecase}}</td>

                                                            
    
                                                            <td *ngIf="i==0 || i==1" style="padding: 0;  cursor: pointer; background-color: rgb(255, 202, 202);" class="tableColumnStyle">High</td>
    
                                                            <td *ngIf="i==2 || i==3" style="padding: 0;  cursor: pointer; background-color: rgb(255, 185, 94);" class="tableColumnStyle">Medium</td>
    
                                                            <td *ngIf="i==4" style="padding: 0;  cursor: pointer; background-color: rgb(255, 220, 105);" class="tableColumnStyle">Low</td>
    
                                                            <td style="padding: 0;  cursor: pointer;" class="tableColumnStyle">{{rowline.IMD_COUNT}}</td>
    
                                                            <td style="padding: 0;  cursor: pointer;" class="tableColumnStyle">{{rowline.REMARKS}}</td>
                                                            
                                                        </tr>
        
        
                                                    </ng-container>
        
                                                </tbody>
                                            </table>
                                        </div>

                                        
                                    </div>


                                </div> -->


                                <div class="col-12"  style="max-height: 275px!important;">
                                    
                                    <div class="row" style="height: 145px; display: flex; gap: 30px">
                                        



                                        <!-- <div class="col box_border">
                                            <div class="d-flex justify-content-between align-items-center p-3 bg-orange bg-opacity-15 rounded-3 "><span class="text-orange"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="people-group" class="svg-inline--fa fa-people-group " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" style="font-size: 5vw;"><path fill="currentColor" d="M72 88a56 56 0 1 1 112 0A56 56 0 1 1 72 88zM64 245.7C54 256.9 48 271.8 48 288s6 31.1 16 42.3l0-84.7zm144.4-49.3C178.7 222.7 160 261.2 160 304c0 34.3 12 65.8 32 90.5l0 21.5c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32l0-26.8C26.2 371.2 0 332.7 0 288c0-61.9 50.1-112 112-112l32 0c24 0 46.2 7.5 64.4 20.3zM448 416l0-21.5c20-24.7 32-56.2 32-90.5c0-42.8-18.7-81.3-48.4-107.7C449.8 183.5 472 176 496 176l32 0c61.9 0 112 50.1 112 112c0 44.7-26.2 83.2-64 101.2l0 26.8c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32zm8-328a56 56 0 1 1 112 0A56 56 0 1 1 456 88zM576 245.7l0 84.7c10-11.3 16-26.1 16-42.3s-6-31.1-16-42.3zM320 32a64 64 0 1 1 0 128 64 64 0 1 1 0-128zM240 304c0 16.2 6 31 16 42.3l0-84.7c-10 11.3-16 26.1-16 42.3zm144-42.3l0 84.7c10-11.3 16-26.1 16-42.3s-6-31.1-16-42.3zM448 304c0 44.7-26.2 83.2-64 101.2l0 42.8c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32l0-42.8c-37.8-18-64-56.5-64-101.2c0-61.9 50.1-112 112-112l32 0c61.9 0 112 50.1 112 112z"></path></svg></span><div class="ms-4"><h5 class="purecounter fw-bold pb-2" style="font-size: 2vw;">9</h5><p class="mb-0 h6 fw-light">Total Batches</p></div></div>
                                        </div> -->


                                        <div class="col box_border" style="height:100%;text-align: center; justify-items: center;  padding:40px!important;  background-color: #eff1f2;  border-radius: 5px; overflow-y: hidden;">
                                            <!-- <div class="row" style="height: 50%; font-size: 24px; font-weight: 600; color:#000000; display: flex; justify-content:center; align-items: center;">
                                                YTD &nbsp;<span style="font-size: 14px;">(in cr)</span>
                                            </div>


                                            <div class="row" style="height: 50%; font-size: 44px; font-weight: 600; color:#6d6d6d; display: flex; justify-content:center;">
                                               
                                                {{formatNumber(mtd_ytd_ftm_data[0].ytd)}}
                                            </div> -->
                                            <span style=" font-size: 32px; font-weight: 600; color:#000000; position: absolute; top:10px; left: 10px;">YTD <span style="font-size: 14px; margin-top: -10px;">(in Cr)</span></span>

                                            <div class="row" style="height: 100%; font-size: 50px; font-weight: 600; color:#000000; display: flex; justify-content:center; align-items: center;">
                                               
                                                {{formatNumber(mtd_ytd_ftm_data[0].ytd)}}
                                                <!-- {{mtd_ytd_ftm_data[0].ytd}} -->
                                            </div>
                                        </div>


                                        <div class="col box_border" style="height:100%;text-align: center; justify-items: center;  padding:40px!important;  background-color: #eff1f2;  border-radius: 5px; overflow-y: hidden;">
                                            <!-- <div class="row" style="height: 50%; font-size: 24px; font-weight: 600; color:#000000; display: flex; justify-content:center; align-items: center;">
                                                MTD &nbsp;<span style="font-size: 14px;">(in cr)</span>
                                            </div>
                                            <div class="row" style="height: 50%; font-size: 44px; font-weight: 600; color:#6d6d6d; display: flex; justify-content:center;">
                                                
                                                {{formatNumber(mtd_ytd_ftm_data[0].mtd)}}
                                            </div> -->

                                            <span style=" font-size: 32px; font-weight: 600; color:#000000; position: absolute; top:10px; left: 10px;">MTD <span style="font-size: 14px; margin-top: -10px;">(in Cr)</span></span>

                                            <div class="row" style="height: 100%; font-size: 50px; font-weight: 600; color:#000000; display: flex; justify-content:center; align-items: center;">
                                               
                                                {{formatNumber(mtd_ytd_ftm_data[0].mtd)}}
                                                <!-- {{mtd_ytd_ftm_data[0].mtd}} -->
                                            </div>
                                        </div>


                                        <div class="col box_border" style="height:100%;text-align: center; justify-items: center;  padding:40px!important;  background-color: #eff1f2;  border-radius: 5px; overflow-y: hidden;">
                                            <!-- <div class="row" style="height: 50%; font-size: 24px; font-weight: 600; color:#000000; display: flex; justify-content:center; align-items: center;">
                                                FTM &nbsp;<span style="font-size: 14px;">(in cr)</span>
                                            </div>
                                            <div class="row" style="height: 50%; font-size: 44px; font-weight: 600; color:#6d6d6d; display: flex; justify-content:center;">
                                               
                                                {{formatNumber(mtd_ytd_ftm_data[0].ftm)}}
                                            </div> -->

                                            <span style=" font-size: 32px; font-weight: 600; color:#000000; position: absolute; top:10px; left: 10px;">FTM <span style="font-size: 14px; margin-top: -10px;">(in Cr)</span></span>

                                            <div class="row" style="height: 100%; font-size: 50px; font-weight: 600; color:#000000; display: flex; justify-content:center; align-items: center;">
                                               
                                                {{formatNumber(mtd_ytd_ftm_data[0].ftm)}}
                                                <!-- {{mtd_ytd_ftm_data[0].ftm}} -->
                                            </div>
                                        </div>

                                    </div>











                                    <div class="row filterSection"  *ngIf="!showSingleline">



                                        <div class="row" style="width:100%">


                                            <div class="col"  style=" padding: 10px!important; padding-bottom: 0px!important;">
                                                <!-- <div class="multiselectFilter" > -->
                                                    <ng-multiselect-dropdown [placeholder]="'Month Year'" [settings]="month_dropdownSettings"
                                                        [data]="month_dropdownList" [(ngModel)]="month_selectedItems"
                                                        (onSelect)="showMonthFlag=false" (onDeSelect)="showMonthFlag = false" >
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>


                                            <div class="col"  style=" padding: 10px!important; padding-bottom: 0px!important;">
                                                <!-- <div class="multiselectFilter" > -->
                                                    <ng-multiselect-dropdown [placeholder]="'LOB'" [settings]="lob_dropdownSettings"
                                                        [data]="lob_dropdownList" [(ngModel)]="lob_selectedItems" >
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>


                                            <div class="col"  style=" padding: 10px!important; padding-bottom: 0px!important;">
                                                <!-- <div class="multiselectFilter" > -->
                                                    <ng-multiselect-dropdown [placeholder]="'Product'" [settings]="product_dropdownSettings"
                                                        [data]="product_dropdownList" [(ngModel)]="product_selectedItems">
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>

                                            <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                                                <ng-multiselect-dropdown [placeholder]="'Channel'" [settings]="imdChannel_dropdownSettings"
                                                    [data]="imdChannel_dropdownList" [(ngModel)]="imdChannel_selectedItems"
                                                    (onSelect)="get_subChannelList()" (onSelectAll)="get_subChannelList()"
                                                    (onDeSelect)="get_subChannelList()" (onDeSelectAll)="get_subChannelList()">
                                                </ng-multiselect-dropdown>
                                            </div>
                                
                                            
                                        </div>

                                        <br/>



                                        <div class="row" style="width:100%">
                                
                                            <div class="col" style=" padding: 10px!important; padding-bottom: 0px!important; ">
                                                <!-- <div class="multiselectFilter"> -->
                                                    <ng-multiselect-dropdown [placeholder]="'Zone'" [settings]="zone_dropdownSettings"
                                                        [data]="zone_dropdownList" [(ngModel)]="zone_selectedItems"
                                                        (onSelect)="get_state_list(); get_location_list()"
                                                        (onSelectAll)="get_state_list(); get_location_list()"
                                                        (onDeSelect)="get_state_list(); get_location_list()"
                                                        (onDeSelectAll)="get_state_list(); get_location_list()">
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>
                                
                                            <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                                                <!-- <div class="multiselectFilter"> -->
                                                    <ng-multiselect-dropdown [placeholder]="'State'" [settings]="state_dropdownSettings"
                                                        [data]="state_dropdownList" [(ngModel)]="state_selectedItems"
                                                        (onSelect)="get_location_list()" (onSelectAll)="get_location_list()"
                                                        (onDeSelect)="get_location_list()" (onDeSelectAll)="get_location_list()">
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>
                                
                                            <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                                                    <ng-multiselect-dropdown [placeholder]="'Location'" [settings]="location_dropdownSettings"
                                                        [data]="location_dropdownList" [(ngModel)]="location_selectedItems">
                                                    </ng-multiselect-dropdown>
                                            </div>


                                            <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                                                <div class="row" style="padding:0!important; padding-top: 5px!important ">
                                                    <div class="" style="padding:0; width:48%">
                                                        <button class="filterApplyButton" style=" background-color: rgb(238, 99, 99); height: 36px; border-radius: 5px; border: none;" (click)="resetAll();getHeroAgents();getBottomAgents();"
                                                            >
                                                            <span>Reset</span>
                                                        </button>
                                    
                                                    </div>
                              
                              
                                                    <div class="" style="padding:0; width:4%"></div>
                              
                                                    
                                    
                                                    <div class="col" style="padding:0; width: 48%">
                                                        <button class="filterApplyButton" style="background-color: rgb(0, 95, 204);  height: 36px; border-radius: 5px; border: none" (click)="filteBtn()">
                                                            <span>Apply</span>
                                                        </button>
                                    
                                                    </div> 
                                                </div>
                                              </div>


                                        </div>

                                    </div>

                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    <div class="row filterSection"   *ngIf="showSingleline">



                                        <!-- <div class="row"> -->


                                            <div class="col"  style=" padding: 10px!important; padding-bottom: 0px!important;">
                                                <!-- <div class="multiselectFilter" > -->
                                                    <ng-multiselect-dropdown [placeholder]="'Month Year'" [settings]="month_dropdownSettings"
                                                        [data]="month_dropdownList" [(ngModel)]="month_selectedItems"
                                                        (onSelect)="showMonthFlag=false" (onDeSelect)="showMonthFlag = false" >
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>


                                            <div class="col"  style=" padding: 10px!important; padding-bottom: 0px!important;">
                                                <!-- <div class="multiselectFilter" > -->
                                                    <ng-multiselect-dropdown [placeholder]="'LOB'" [settings]="lob_dropdownSettings"
                                                        [data]="lob_dropdownList" [(ngModel)]="lob_selectedItems" >
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>


                                            <div class="col"  style=" padding: 10px!important; padding-bottom: 0px!important;">
                                                <!-- <div class="multiselectFilter" > -->
                                                    <ng-multiselect-dropdown [placeholder]="'Product'" [settings]="product_dropdownSettings"
                                                        [data]="product_dropdownList" [(ngModel)]="product_selectedItems">
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>

                                            <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                                                <ng-multiselect-dropdown [placeholder]="'Channel'" [settings]="imdChannel_dropdownSettings"
                                                    [data]="imdChannel_dropdownList" [(ngModel)]="imdChannel_selectedItems"
                                                    (onSelect)="get_subChannelList()" (onSelectAll)="get_subChannelList()"
                                                    (onDeSelect)="get_subChannelList()" (onDeSelectAll)="get_subChannelList()">
                                                </ng-multiselect-dropdown>
                                            </div>
                                
                                            <div class="col" style=" padding: 10px!important; padding-bottom: 0px!important; ">
                                                <!-- <div class="multiselectFilter"> -->
                                                    <ng-multiselect-dropdown [placeholder]="'Zone'" [settings]="zone_dropdownSettings"
                                                        [data]="zone_dropdownList" [(ngModel)]="zone_selectedItems"
                                                        (onSelect)="get_state_list(); get_location_list()"
                                                        (onSelectAll)="get_state_list(); get_location_list()"
                                                        (onDeSelect)="get_state_list(); get_location_list()"
                                                        (onDeSelectAll)="get_state_list(); get_location_list()">
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>
                                
                                            <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                                                <!-- <div class="multiselectFilter"> -->
                                                    <ng-multiselect-dropdown [placeholder]="'State'" [settings]="state_dropdownSettings"
                                                        [data]="state_dropdownList" [(ngModel)]="state_selectedItems"
                                                        (onSelect)="get_location_list()" (onSelectAll)="get_location_list()"
                                                        (onDeSelect)="get_location_list()" (onDeSelectAll)="get_location_list()">
                                                    </ng-multiselect-dropdown>
                                                <!-- </div> -->
                                            </div>
                                
                                            <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                                                    <ng-multiselect-dropdown [placeholder]="'Location'" [settings]="location_dropdownSettings"
                                                        [data]="location_dropdownList" [(ngModel)]="location_selectedItems">
                                                    </ng-multiselect-dropdown>
                                            </div>
                                
                                            
                                
                                            <!-- <div class="col" style=" padding: 10px!important; padding-bottom: 0px!important; ">
                                                    <ng-multiselect-dropdown [placeholder]="'Sub Channel'"
                                                        [settings]="subChannelCodeName_dropdownSettings" [data]="subChannelCodeName_dropdownList"
                                                        [(ngModel)]="subChannelCodeName_selectedItems">
                                                    </ng-multiselect-dropdown>
                                            </div> -->
                                
                                            <!-- <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                                                <div class="row" style="padding:0!important; padding-top: 5px!important ">
                                                    <div class="col-6" style="padding:0">
                                                        <button class="filterApplyButton" style=" background-color: rgb(238, 99, 99); height: 36px; border-radius: 5px;;"
                                                            (click)="resetAll();getHeroAgents();getBottomAgents();">
                                                            <span>Reset</span>
                                                        </button>
                                    
                                                    </div>
                                    
                                                    <div class="col-6" style="padding:0; ">
                                                        <button class="filterApplyButton" style="background-color: rgb(0, 95, 204);  height: 36px; border-radius: 5px;" (click)="filteBtn()
                                                         ">
                                                            <span>Apply</span>
                                                        </button>
                                    
                                                    </div> 
                                                </div>
                                            </div> -->





                                            <div class="col" style=" padding: 10px!important;  padding-bottom: 0px!important;">
                                                <div class="row" style="padding:0!important; padding-top: 5px!important ">
                                                    <div class="" style="padding:0; width:48%">
                                                        <button class="filterApplyButton" style=" background-color: rgb(238, 99, 99); height: 36px; border-radius: 5px; border: none;" (click)="resetAll();getHeroAgents();getBottomAgents();"
                                                            >
                                                            <span>Reset</span>
                                                        </button>
                                    
                                                    </div>
                              
                              
                                                    <div class="" style="padding:0; width:4%"></div>
                              
                                                    
                                    
                                                    <div class="col" style="padding:0; width: 48%">
                                                        <button class="filterApplyButton" style="background-color: rgb(0, 95, 204);  height: 36px; border-radius: 5px; border: none" (click)="filteBtn()">
                                                            <span>Apply</span>
                                                        </button>
                                    
                                                    </div> 
                                                </div>
                                              </div>
                                        <!-- </div> -->

                                    </div>



                                    <!-- <div class="row" style="height: 100%; display: flex; gap: 30px;">
                                        <div class="col box_border" style="height: 100%; text-align: center; justify-items: center; border-radius: 20px; padding: 40px !important; padding-top: 0 !important; background-color: #ffffff; border-radius: 5px; overflow-y: hidden;">
                                            YTD
                                        </div>
                                    
                                        <div class="col box_border" style="height: 100%; text-align: center; justify-items: center; border-radius: 20px; padding: 40px !important; padding-top: 0 !important; background-color: #ffffff; border-radius: 5px; overflow-y: hidden;">
                                            MTD
                                        </div>
                                    
                                        <div class="col box_border" style="height: 100%; text-align: center; justify-items: center; border-radius: 20px; padding: 40px !important; padding-top: 0 !important; background-color: #ffffff; border-radius: 5px; overflow-y: hidden;">
                                            FTM
                                        </div>
                                    </div> -->
                                </div>




                                <!-- <div class="col-4"  style="height: 275px!important;">

                                    

                                        <div class="box_border" style="height:100%;text-align: center; justify-items: center;border-radius: 20px;  padding:40px!important; padding-top: 0!important; background-color: #ffffff;  border-radius: 5px; overflow-y: hidden;">


                                        <div class="row" style="display: flex; justify-content: center; padding: 10px!important">
                                            <span style="font-weight: bold; font-size: 18px;">Actionable {{projectName_plural}}</span>
                                            &nbsp;&nbsp;
                                            <select  [(ngModel)]="limit" (change)="getHeroAgents();getBottomAgents();" style="max-width: 70px;">
                                                <option value="5">5</option>
                                                <option value="10">10</option>
                                                <option value="15">15</option>
                                                <option value="20">20</option>
                                                <option value="25">25</option>
                                            </select>
                                        </div>



                                        





                                        <div class="row" style="overflow-y: scroll; height: 195px; width: 100%;">
                                            <div class="col-6" style="padding: 0; padding-right: 15px;">
                                                <table class="table table-hover table-striped" style="text-align: center;">
                                                    <thead style="position: sticky; top: 0; background: #4ebf1a;">
                                                        <tr class="" style="font-size: 16px!important;">
                                                            <th class="tableColumnStyle" style="padding: 10px;">Hero</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <ng-container *ngFor="let rowline of heroAgents; let i=index;">
                                                            <tr style="padding: 0; font-size: 16px!important;">
                                                                <td style="padding: 0; cursor: pointer;" class="tableColumnStyle">
                                                                    

                                                                    <i class="fa fa-user" style="color:rgb(63, 63, 63);" (click)="goToScoreCard(rowline.IMD_CODE);"></i>
                                                                    {{rowline.IMD_CODE}}
                                                                </td>
                                                            </tr>
                                                        </ng-container>
                                                    </tbody>
                                                </table>
                                            </div>
                                        
                                            <div class="col-6" style="padding: 0; padding-left: 15px;">
                                                <table class="table table-hover" style="text-align: center; justify-items: center;">
                                                    <thead style="position: sticky; top: 0; background: #f39f73;">
                                                        <tr class="" style="font-size: 16px!important;">
                                                            <th class="tableColumnStyle" style="padding: 10px;">Bottom</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <ng-container *ngFor="let rowline of bottomAgents; let i=index;">
                                                            <tr [ngClass]="i%2 == 0? 'highlighRow':''" style="padding: 0; font-size: 16px!important;">
                                                                <td style="padding: 0; cursor: pointer;" class="tableColumnStyle">

                                                                    <i class="fa fa-user" style="color:rgb(63, 63, 63);" (click)="goToScoreCard(rowline.IMD_CODE);"></i>
                                                                    {{rowline.IMD_CODE}}
                                                                </td>
                                                            </tr>
                                                        </ng-container>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        

                                    </div>

                                    

                                    

                                    

                                </div> -->

                                





                            </div>

                        </div>












                        <!-- <div  class="col-12" style=" padding: 45px;padding-top: 0px;padding-bottom: 30px; max-height: 700px;">

                            <div class="box_border"   style=" border-radius: 20px;  background-color: #ffffff;   border-radius: 5px;">
                                <div class="row" style="padding:10px!important;  display: flex;justify-content: center;">
                                    
                                        <span style="font-weight: bold; font-size: 18px;">Band Trend Graph</span>
                                    
                                </div>
                                <div class="row" style="padding: 40px!important; padding-top: 0px!important;  ">

                                    <div class="col-12" style="display: flex; justify-content: center;">
                                        <div id="bandComparison" style="width: 95%; height: 100%;"></div>

                                        
                                    </div>
                                </div>
                            </div>
                            
                            
                        </div> -->




                        






                        <div class="col-12" style=" padding: 45px;padding-top: 0px;padding-bottom: 30px; ">

                            <div  class="box_border"  style=" border-radius: 20px;  background-color: #ffffff; border-radius: 5px; position: relative;">


                                <span *ngIf="getComparisonStatus"  style="font-weight: bold; font-size: 14px; position: absolute; left: 40px; top: 10px; padding: 5px; background-color: #9ed3ff; color: #000000; border-radius: 5px; font-weight: 500; cursor: pointer;" (click)="openModal1('showBandTrendGraph', showBandTrendGraph); bandTrendGraphMakingOnly();" title="Click Here to Get More Details">Show Graph</span>

                                <span *ngIf="getComparisonStatus" style="font-weight: bold; font-size: 14px; position: absolute; right: 40px; top: 10px; padding: 5px; background-color: #9ed3ff; color: #000000; border-radius: 5px; font-weight: 500; cursor: pointer;" title="Download" (click)="download_band_trend_table_total()">Download</span>


                                <!-- <span style="font-weight: bold; font-size: 14px; position: absolute; right: 32px; top: 10px; padding: 5px; color: #000000; border-radius: 5px; font-weight: 500; cursor: pointer;"><mat-icon title="Download" >download</mat-icon></span> -->

                                

                                <div class="row" style="padding:10px!important;  display: flex;justify-content: center;">
                                    
                                        <span style="font-weight: bold; font-size: 18px;">Band Trend Table</span>
                                    
                                </div>
                                <div class="row" style="padding: 40px!important; padding-top: 0px!important;  ">

                                    <!-- <div class="col-12" style="display: flex; justify-content: center;">
                                        <div id="bandComparison" style="width: 95%; height: 100%;"></div>

                                        
                                    </div> -->



                                    <div class="col-12" style="padding:0!important; ">

                                        <div *ngIf="bandtendTableStatus" class="spinner-border text-primary" role="status" style="position: relative; top: 50%; opacity: 0.2;">
                                            <span class="sr-only">Loading...</span>
                                        </div>


                                        <table *ngIf="bandComparison_table_show" class="table table-hover table-striped" style="border-radius: 10px!important; height: 100%;">


                                            
                                            <thead style="background: #ced4da; color:black;">
                                                <tr class="" style="font-size: 16px!important;">
    
                                                    <th class="tableColumnStyle" style="padding: 10px;  ">

                                                        
                                                        <!-- <span  style="background-color: #eae5ff; padding:3px; border: 1px solid #947fff; border-radius: 4px; box-shadow: rgba(0, 0, 0, 0.16) 0px 3px 6px, rgba(0, 0, 0, 0.23) 0px 3px 6px; cursor: pointer;"  (click)="showBrandTrend_percent = !showBrandTrend_percent">
                                                            <span *ngIf="showBrandTrend_percent == false">%</span>
                                                            <span *ngIf="showBrandTrend_percent == true">Num.</span>
                                                        </span>                                                         -->
                                                        Band
                                                    </th>
                                                    <th *ngFor="let month of ytdBandMovementMonthColumns" class="tableColumnStyle" style="padding: 10px; ">{{formatMonthYear(month)}}</th>
    
                                                </tr>
    
                                            </thead>
    
                                            <!-- <tbody  *ngIf="showBrandTrend_percent == false">
                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;  cursor: pointer; background-color: #0cc078;" class="text-center">A+</td>
                                                        <td *ngFor="let count of getcomparisonData_aplus" style="padding: 0; padding-top: 10px;   cursor: pointer;" class="tableColumnStyle">{{count || 0 | indianNumber}}</td>
                                                    </tr>

                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px;  padding-top: 10px;  cursor: pointer; background-color: #79de79;" class="text-center">A</td>
                                                        <td *ngFor="let count of getcomparisonData_a" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count || 0 | indianNumber}}</td>
                                                    </tr>

                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #ffd366;" class="text-center">B</td>
                                                        <td *ngFor="let count of getcomparisonData_b" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count || 0 | indianNumber}}</td>
                                                    </tr>

                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px;  padding-top: 10px;  cursor: pointer; background-color: #ff8439;" class="text-center">C</td>
                                                        <td *ngFor="let count of getcomparisonData_c" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count || 0 | indianNumber}}</td>
                                                    </tr>

                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #e97282;" class="text-center">D</td>
                                                        <td *ngFor="let count of getcomparisonData_d" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count || 0 | indianNumber}}</td>
                                                    </tr>


                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #b40000; color: #ffffff" class="text-center">E</td>
                                                        <td *ngFor="let count of getcomparisonData_e" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count || 0 | indianNumber}}</td>
                                                    </tr>


                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #800000; color: #ffffff" class="text-center">Zero Business</td>
                                                        <td *ngFor="let count of getcomparisonData_z" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count || 0 | indianNumber}}</td>
                                                    </tr>


                                                    <tr style="padding: 0; font-size: 16px!important; border-bottom: 1px solid #d6d6d6;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #e0e0e0;" class="text-center">Total</td>
                                                        <td *ngFor="let count of getcomparisonData_total" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count || 0 | indianNumber}}</td>
                                                    </tr>
    
                                            </tbody> -->




                                            <tbody *ngIf="showBrandTrend_percent == false">
                                                
                                                <tr style="padding: 0; font-size: 16px!important;">
                                                    <td style="padding: 0; padding-left: 0px; padding-top: 10px; cursor: pointer; background-color: #0cc078;" class="text-center">A+</td>
                                                    <td
                                                        *ngFor="let count of getcomparisonData_aplus; let i = index"
                                                        [ngClass]="compareWithLeft(i, count, getcomparisonData_aplus[i - 1])"
                                                        style="padding: 0; padding-top: 10px; cursor: pointer;"
                                                        class="tableColumnStyle"
                                                    >
                                                        {{ count || 0 | indianNumber }}
                                                    </td>
                                                </tr>
                                            
                                                
                                                <tr style="padding: 0; font-size: 16px!important;">
                                                    <td style="padding: 0; padding-left: 0px; padding-top: 10px; cursor: pointer; background-color: #79de79;" class="text-center">A</td>
                                                    <td
                                                        *ngFor="let count of getcomparisonData_a; let i = index"
                                                        [ngClass]="compareWithLeft(i,count, getcomparisonData_a[i - 1])"
                                                        style="padding: 0; padding-top: 10px; cursor: pointer;"
                                                        class="tableColumnStyle"
                                                    >
                                                        {{ count || 0 | indianNumber }}
                                                    </td>
                                                </tr>
                                            
                                                
                                                <tr style="padding: 0; font-size: 16px!important;">
                                                    <td style="padding: 0; padding-left: 0px; padding-top: 10px; cursor: pointer; background-color: #ffd366;" class="text-center">B</td>
                                                    <td
                                                        *ngFor="let count of getcomparisonData_b; let i = index"
                                                        [ngClass]="compareWithLeft(i,count, getcomparisonData_b[i - 1])"
                                                        style="padding: 0; padding-top: 10px; cursor: pointer;"
                                                        class="tableColumnStyle"
                                                    >
                                                        {{ count || 0 | indianNumber }}
                                                    </td>
                                                </tr>
                                            
                                                
                                                <tr style="padding: 0; font-size: 16px!important;">
                                                    <td style="padding: 0; padding-left: 0px; padding-top: 10px; cursor: pointer; background-color: #ff8439;" class="text-center">C</td>
                                                    <td
                                                        *ngFor="let count of getcomparisonData_c; let i = index"
                                                        [ngClass]="compareWithLeft(i,count, getcomparisonData_c[i - 1])"
                                                        style="padding: 0; padding-top: 10px; cursor: pointer;"
                                                        class="tableColumnStyle"
                                                    >
                                                        {{ count || 0 | indianNumber }}
                                                    </td>
                                                </tr>
                                            
                                                
                                                <tr style="padding: 0; font-size: 16px!important;">
                                                    <td style="padding: 0; padding-left: 0px; padding-top: 10px; cursor: pointer; background-color: #e97282;" class="text-center">D</td>
                                                    <td
                                                        *ngFor="let count of getcomparisonData_d; let i = index"
                                                        [ngClass]="compareWithLeft(i,count, getcomparisonData_d[i - 1])"
                                                        style="padding: 0; padding-top: 10px; cursor: pointer;"
                                                        class="tableColumnStyle"
                                                    >
                                                        {{ count || 0 | indianNumber }}
                                                    </td>
                                                </tr>
                                            
                                               
                                                <tr style="padding: 0; font-size: 16px!important;">
                                                    <td style="padding: 0; padding-left: 0px; padding-top: 10px; cursor: pointer; background-color: #b40000; color: #ffffff;" class="text-center">E</td>
                                                    <td
                                                        *ngFor="let count of getcomparisonData_e; let i = index"
                                                        [ngClass]="compareWithLeft(i,count, getcomparisonData_e[i - 1])"
                                                        style="padding: 0; padding-top: 10px; cursor: pointer;"
                                                        class="tableColumnStyle"
                                                    >
                                                        {{ count || 0 | indianNumber }}
                                                    </td>
                                                </tr>
                                            
                                               
                                                <tr style="padding: 0; font-size: 16px!important; border-bottom: 1px solid #d6d6d6;">
                                                    <td style="padding: 0; padding-left: 0px; padding-top: 10px; cursor: pointer; background-color: #e0e0e0;" class="text-center">Total</td>
                                                    <td
                                                        *ngFor="let count of getcomparisonData_total; let i = index"
                                                        [ngClass]="compareWithLeft(i,count, getcomparisonData_total[i - 1])"
                                                        style="padding: 0; padding-top: 10px; cursor: pointer;"
                                                        class="tableColumnStyle"
                                                    >
                                                        {{ count || 0 | indianNumber }}
                                                    </td>
                                                </tr>
                                            </tbody>
                                            



                                            <tbody  *ngIf="showBrandTrend_percent == true">
                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;  cursor: pointer; background-color: #0cc078;" class="text-center">A+</td>
                                                        <td *ngFor="let count of getcomparisonData_aplus_percent" style="padding: 0; padding-top: 10px;   cursor: pointer;" class="tableColumnStyle">{{count}}%</td>
                                                    </tr>

                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px;  padding-top: 10px;  cursor: pointer; background-color: #79de79;" class="text-center">A</td>
                                                        <td *ngFor="let count of getcomparisonData_a_percent" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count}}%</td>
                                                    </tr>

                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #ffd366;" class="text-center">B</td>
                                                        <td *ngFor="let count of getcomparisonData_b_percent" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count}}%</td>
                                                    </tr>

                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px;  padding-top: 10px;  cursor: pointer; background-color: #ff8439;" class="text-center">C</td>
                                                        <td *ngFor="let count of getcomparisonData_c_percent" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count}}%</td>
                                                    </tr>

                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #e97282;" class="text-center">D</td>
                                                        <td *ngFor="let count of getcomparisonData_d_percent" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count}}%</td>
                                                    </tr>

                                                    <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #b40000;  color: #ffffff;" class="text-center">E</td>
                                                        <td *ngFor="let count of getcomparisonData_e_percent" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count}}%</td>
                                                    </tr>

                                                    <!-- <tr style="padding: 0; font-size: 16px!important;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #800000; color: #ffffff;" class="text-center">Zero Business</td>
                                                        <td *ngFor="let count of getcomparisonData_z_percent" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">{{count}}%</td>
                                                    </tr> -->


                                                    <tr style="padding: 0; font-size: 16px!important; border-bottom: 1px solid #d6d6d6;">
                                                        <td style="padding: 0;padding-left: 0px; padding-top: 10px;   cursor: pointer; background-color: #e0e0e0;" class="text-center">Total</td>
                                                        <td *ngFor="let count of getcomparisonData_total" style="padding: 0;  padding-top: 10px;  cursor: pointer;" class="tableColumnStyle">
                                                            100%
                                                        </td>
                                                    </tr>
    
                                            </tbody>
                                        </table>
                                    </div>

                                    
                                    <!-- <canvas id="bandComparison" ></canvas> -->
                                </div>
                            </div>
                            
                            
                        </div>



                        <ng-container >


                            <div id="indiaMap_pad" class="col-6" style="height: 400px">

                                <div class="row" style="padding-left: 30px!important; height: 100%; ">
                                    <!-- <div id="indiaMap" style="border-radius: 20px;  width: 100%; height: 100%;  background-color: #ffffff;">
                                        
                                    </div> -->


                                    <div class="box_border"   style="border-radius: 20px;  width: 100%; height: 100%;  background-color: #ffffff;  border-radius: 5px;">
                                        <div id="indiaMap" style="border-radius: 20px;  width: 100%; height: 100%;  background-color: #ffffff;">
                                            <div *ngIf="indiaMapStatus" class="spinner-border text-primary" role="status" style="position: relative; top: 50%;">
                                                <span class="sr-only">Loading...</span>
                                            </div>
                                        </div>


                                        
                                    </div>
                                </div>
                                
                                
                            </div>
    
                            <!-- pie chart -->
                            <div  class="col-6" style="height: 400px">



                                <div class="row" style="padding-right: 30px!important; height: 100%; ">

                                    
                                    <div  class="box_border"  style=" border-radius: 20px;  width: 100%; height: 100%;  background-color: #ffffff;  border-radius: 5px;">

                                        <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center;">
                                            <span *ngIf="lobContribution=='india'" style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">LOB Contribution: India</span>
                                            <span  *ngIf="lobContribution=='state'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">LOB Contribution: {{state_branding_pie}}</span>
                                            <span  *ngIf="lobContribution=='zone'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">LOB Contribution: {{zone_branding_pie | titlecase}}</span>
                                        </div>

                                        <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center; align-items: center; height:90%">
                                            

                                            <div id="getStateWiseLOBDistPie_highchart" style="height: 100%">
                                                <div *ngIf="lobContributionStatus" class="spinner-border text-primary" role="status" style="position: relative; top: 40%;">
                                                    <span class="sr-only">Loading...</span>
                                                </div>
                                            </div>
                                        </div>

                                        
                                    
                                    </div>
                                </div>




                                
                                <!-- <div *ngIf="brandingPiechart_status==false" class="row" style="padding-right: 30px!important; height: 100%;  ">
                                    <div class="col-12" style=" height:600px;  border-radius: 20px;  padding-right: 40px; padding-left: 40px;  background-color: #ffffff; ">
    
                                        <div class="row" style="padding:10px!important;  display: flex;justify-content: center;">
                                            <span style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">Zonewise Banding</span>
                                        </div>
                                        <div class="row" style="height: 90%; display: flex; align-items: center; justify-content: center; ">
                                            
                                            <canvas id="zoneWiseBranding_Chart"  ></canvas>
                                        </div>
                                        
                                    </div>
                                </div> -->
    
    
    
                                <!-- <div *ngIf="brandingPiechart_status==true"  class="row" style="padding-right: 30px!important; ">
                                    <div class="col-12" style="width: 100%; height:600px;  border-radius: 20px;  padding-right: 40px; padding-left: 40px;   background-color: #ffffff;">
    
                                        <div class="row" >
                                            
                                            <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center; position: relative;">
                                                <span *ngIf="pieChartFor == 'zone'" style=" font-size: 18px; font-weight: bold; color: #2c2c2c;"> Banding Distribution in Zone: {{zone_branding_pie | titlecase}}</span>
    
    
                                                <span *ngIf="pieChartFor == 'state'" style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">Banding Distribution in State: {{state_branding_pie}}</span>
    
                                                <mat-icon style="position: absolute; right: 0;" 

                                                (click)=" backBtn_BandingDistribution() ">keyboard_backspace</mat-icon>
                                            </div>
                                           
    
    
                                        </div>
                                        <div class="row" style="padding:10px!important;  display: flex;justify-content: center; align-items: center; height:90%">
                                            
                                            <div id="getBandingPie_chart_hc"></div>
                                        </div>
                                        
                                    </div>
                                </div> -->



                                
                            </div>

                            
                            <div class="col-12" style="height: 30px;">

                            </div>




                            <div  class="col-6" style="height: 400px">


                                <div *ngIf="brandingPiechart_status==false" class="row" style="padding-left: 30px!important; height: 100%;  ">
                                    <div class="col-12 box_border" style=" height:400px;  border-radius: 20px;  padding-right: 40px; padding-left: 40px;  background-color: #ffffff;  border-radius: 5px; ">
    
                                        <div class="row" style="padding:10px!important;  display: flex;justify-content: center;">
                                            <span style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">Zonewise Banding</span>
                                        </div>
                                        <div class="row" style="height: 90%; display: flex; align-items: center; justify-content: center; ">
                                            
                                            <!-- <canvas id="zoneWiseBranding_Chart"  ></canvas> -->
                                            <div id="zoneWiseBranding_Chart" style="height: 95%; width: 95%;">
                                                <div *ngIf="zonewiseBandingStatus" class="spinner-border text-primary" role="status" style="position: relative; top: 50%; opacity: 0.2;">
                                                    <span class="sr-only">Loading...</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
    
    
    
                                <div *ngIf="brandingPiechart_status==true"  class="row" style="padding-left: 30px!important; ">
                                    <div class="col-12 box_border" style="width: 100%; height:400px;  border-radius: 20px;  padding-right: 40px; padding-left: 40px;   background-color: #ffffff;  border-radius: 5px;">
    
                                        <div class="row" >
                                            
                                            <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center; position: relative;">
                                                <span *ngIf="pieChartFor == 'zone'" style=" font-size: 18px; font-weight: bold; color: #2c2c2c;"> Banding Distribution in Zone: {{zone_branding_pie | titlecase}}</span>
    
    
                                                <span *ngIf="pieChartFor == 'state'" style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">Banding Distribution in State: {{state_branding_pie}}</span>
    
                                                <mat-icon style="position: absolute; right: 0;" 

                                                (click)=" backBtn_BandingDistribution() ">keyboard_backspace</mat-icon>
                                            </div>
                                           
    
    
                                        </div>
                                        <div class="row" style="padding:10px!important;  display: flex;justify-content: center; align-items: center; height:90%">
                                            
                                            <div id="getBandingPie_chart_hc" style="height: 95%; "></div>
                                        </div>
                                        
                                    </div>
                                </div>






                                <!-- <div class="row" style="padding-left: 30px!important; height: 100%; ">

                                    
                                    <div  style=" border-radius: 20px;  width: 100%; height: 100%;  background-color: #ffffff;">

                                        <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center;">
                                            <span *ngIf="lobContribution=='india'" style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">LOB Contribution: India</span>
                                            <span  *ngIf="lobContribution=='state'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">LOB Contribution: {{state_branding_pie}}</span>
                                            <span  *ngIf="lobContribution=='zone'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">LOB Contribution: {{zone_branding_pie | titlecase}}</span>
                                        </div>

                                        <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center; align-items: center; height:90%">
                                            

                                            <div id="getStateWiseLOBDistPie_highchart"></div>
                                        </div>

                                        
                                    
                                    </div>
                                </div> -->

                                
                            </div>




                            <div  class="col-6" style="height: 400px">

                                <div class="row" style="padding-right: 30px!important; height: 100%; ">

                                    
                                    <div  class="box_border"  style=" border-radius: 20px; height: 100%;  background-color: #ffffff; width:100%;  border-radius: 5px;">

                                        <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center;">
                                            <span style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">Agent Vintage-wise Banding</span>

                                            <span  *ngIf="lobContribution=='state'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">: {{state_branding_pie}}</span>
                                            <span  *ngIf="lobContribution=='zone'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">: {{zone_branding_pie | titlecase}}</span>
                                        </div>

                                        <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center; align-items: center; height:90%;   ">

                                                <!-- <canvas id="lob_Wise_Branding_Chart" style="width: 1600px;" ></canvas> -->

                                            <!-- <canvas id="agentFlagwiseBanding"   ></canvas> -->

                                            <div id="agentFlagwiseBanding" style="height: 95%; width: 95%;">
                                                <div *ngIf="vintagewiseBandingStatus" class="spinner-border text-primary" role="status" style="position: relative; top: 50%;">
                                                    <span class="sr-only">Loading...</span>
                                                </div>
                                            </div>
                                            
                                        </div>

                                        
                                    
                                    </div>
                                </div>
                                
                            </div>





                            <div class="col-12" style="height: 30px;">

                            </div>




                            <div  class="col-12" style="height: 400px">

                                <!-- <div class="row" style="padding-left: 30px!important; height: 100%; "> -->
                                <div class="row" style="padding-left: 30px!important; padding-right: 30px!important; height: 100%; ">

                                    
                                    <div  class="box_border"  style=" border-radius: 20px;  width: 100%; height: 100%;  background-color: #ffffff;  border-radius: 5px;">

                                        <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center;">
                                            <span style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">LOBwise Banding</span>

                                            <span  *ngIf="lobContribution=='state'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">: {{state_branding_pie}}</span>
                                            <span  *ngIf="lobContribution=='zone'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">: {{zone_branding_pie | titlecase}}</span>
                                        </div>

                                        <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center; align-items: center; height:90%">
                                            
                                            

                                            <!-- <canvas id="lob_Wise_Branding_Chart" style="width: 1600px;" ></canvas> -->
                                            <div id="lob_Wise_Branding_Chart" style="width: 95%; height: 95%" >
                                                <div *ngIf="lobwiseBandingStatus" class="spinner-border  text-primary" role="status" style="position: relative; top: 50%;">
                                                    <span class="sr-only">Loading...</span>
                                                </div>
                                            </div>
                                        </div>

                                        
                                    
                                    </div>
                                </div>
                                
                            </div>



                            <div class="col-12" style="height: 30px;">

                            </div>




                            <!-- <div  class="col-12" style="height: 500px">

                                <div class="row" style="padding-left: 30px!important; padding-right: 30px!important; height: 100%; ">

                                    
                                    <div  class="box_border"  style=" border-radius: 20px;  width: 100%; height: 100%;  background-color: #ffffff;  border-radius: 5px;">

                                        <div class="col-12" style="padding:10px!important;  display: flex;justify-content: center;">
                                            <span style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">Background Wise {{projectName}} Count</span>

                                            <span  *ngIf="lobContribution=='state'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">: {{state_branding_pie}}</span>
                                            <span  *ngIf="lobContribution=='zone'"  style=" font-size: 18px; font-weight: bold; color: #2c2c2c;">: {{zone_branding_pie | titlecase}}</span>
                                        </div>

                                        
                                        <div class="col-12" style="padding:10px!important;  display: flex; align-items: center; height:90%;">
                                            <div id="getAgentBackgroundDistBar_chart" style="width: 95%; height: 95%" ></div>
                                        </div>

                                        
                                    
                                    </div>
                                </div>
                                
                            </div> -->




                            <!-- <div  class="col-6" style="height: 600px">
                                
                                <div *ngIf="brandingPiechart_status==false" class="row" style="padding-right: 30px!important; height: 100%;  ">
                                    <div class="col-12" style=" height:600px; border: 1px solid rgba(143, 143, 143, 0.466); border-radius: 10px; box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 2px 0px, rgba(60, 64, 67, 0.15) 0px 2px 6px 2px; padding-right: 40px; padding-left: 40px;  ">
    
                                        <div class="row" style="padding:10px!important;  display: flex;justify-content: center;">
                                            <span style=" font-size: 16px; font-weight: bold; color: #2c2c2c;">LOBwise Banding</span>
                                        </div>
                                        <div class="row" style="height: 90%; display: flex; align-items: center; justify-content: center; ">
                                            
                                            <canvas id="lob_Wise_Branding_Chart"  ></canvas>
                                        </div>
                                        
                                    </div>
                                </div>
                                
                            </div> -->





                            <!-- <div class="col-6 mt-3" style="padding: 2%">                               

                                <div class="row" style=" height: 100%;  ">
                                    <div class="col-12" style=" height:600px; border: 1px solid rgba(143, 143, 143, 0.466); border-radius: 10px; box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 2px 0px, rgba(60, 64, 67, 0.15) 0px 2px 6px 2px; padding-right: 40px; padding-left: 40px;  ">
    
                                        <div class="row" style="padding:10px!important;  display: flex;justify-content: center;">
                                            <span style=" font-size: 16px; font-weight: bold; color: #2c2c2c;">Zonewise Banding</span>
                                        </div>
                                        <div class="row" style="height: 90%; display: flex; align-items: center; justify-content: center; ">
                                            <canvas id="agentFlagwiseBanding"  height="500" style="width:100%" ></canvas>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div> -->

                            <!-- <div class="col-6">
                                
                            </div> -->


                            <div class="col-12" style="height: 55px;">

                            </div>


                        </ng-container>
                        
                        <!-- <br><br> -->


                        <!-- <div class="col-12 mt-3" style=" padding:2%;">
                            <span style="font-weight: bold; font-size: 16px;">Actionable Agents</span>
                            &nbsp;&nbsp;
                            <select [(ngModel)]="limit" (change)="getHeroAgents();getBottomAgents();">
                                <option value="5">5</option>
                                <option value="10">10</option>
                                <option value="15">15</option>
                                <option value="20">20</option>
                                <option value="25">25</option>
                            </select>

                            <br><br>

                            <div class="row">

                                <div class="col-6">
                                    <table class="table table-hover" style="text-align: center; justify-items: center;">


                                        <thead>
                                            <tr class="" style="background: #4ebf1a;">

                                                <th class="tableColumnStyle" style="padding: 0; ">
                                                    Hero Agents</th>
                                            </tr>

                                        </thead>

                                        <tbody>
                                            <ng-container *ngFor="let rowline of heroAgents; let i=index;">
                                                <tr [ngClass]="i%2 == 0? 'highlighRow':''" style="padding: 0;">
                                                    <td style="padding: 0;  cursor: pointer;" class="tableColumnStyle">

                                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(63, 63, 63)" (click)="
                                                            goToScoreCard(rowline.IMD_CODE);
                                                            
                                                            ">account_circle</mat-icon>
                                                        

                                                        {{rowline.IMD_CODE}}
                                                    </td>
                                                </tr>

                                            </ng-container>

                                        </tbody>
                                    </table>

                                </div>

                                <div class="col-6">
                                    <table class="table table-hover" style="text-align: center; justify-items: center;">


                                        <thead>
                                            <tr class="" style="background: #f39f73;">

                                                <th class="tableColumnStyle" style="padding: 0; ">Bottom Agents</th>

                                            </tr>

                                        </thead>

                                        <tbody>
                                            <ng-container *ngFor="let rowline of bottomAgents; let i=index;">
                                                <tr [ngClass]="i%2 == 0? 'highlighRow':''" style="padding: 0;">
                                                    <td style="padding: 0;  cursor: pointer;" class="tableColumnStyle">

                                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(63, 63, 63)" (click)="
                                                            getImdDetails(rowline.IMD_CODE); getScoreCardDetails(rowline.IMD_CODE);getRecommendations(rowline.IMD_CODE); getTotalGraph_rep(rowline.IMD_CODE);getLRvsCAQGraphs(rowline.IMD_CODE);getLobPieGraphs(rowline.IMD_CODE);imdsearched = true;
                                                            ">account_circle</mat-icon>

                                                        {{rowline.IMD_CODE}}
                                                    </td>
                                                    
                                                </tr>

                                            </ng-container>

                                        </tbody>
                                    </table>

                                </div>

                            </div>

                        </div> -->
                        

                    </div>
                </div>
                <!-- <div class="col-1"></div> -->


                <!-- <div class="col-7" style="text-align: center; padding:2%;box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;">

                    <img width="35px;" src="assets/image/scorecard.png" alt=""> &nbsp; &nbsp;
                    <span style="font-weight: bold; font-size: 18px;">Agenct Scorecard</span>
                    <br><br>
                    <div class="row">

                        <div class="col-2" style="font-weight: bold; font-size: 16px; ">
                            <i class="fa fa-filter"></i> &nbsp;
                            <span>Filter</span>
                        </div>

                        <div class="col-4" style="padding-right: 0px; "><input type="text" class="form-control"
                                style="height:25px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-top-left-radius: 5px; border-bottom-left-radius: 5px;"
                                name="" id="" [(ngModel)]="searchImdCode">
                        </div>
                        <div class="col-1" style="padding-left:0; ">
                            <div style="background-color: #535353;height:25px;color:white; border-top-right-radius: 5px; border-bottom-right-radius: 5px; cursor: pointer;"
                                title="Search"
                                (click)="getImdDetails(searchImdCode); getScoreCardDetails(searchImdCode);getRecommendations(searchImdCode); getTotalGraph_rep(searchImdCode);getLRvsCAQGraphs(searchImdCode);getLobPieGraphs(searchImdCode);imdsearched = true;">
                                <mat-icon>search</mat-icon>
                            </div>
                        </div>
                        <div class="col-3 text-left">
                            <button
                                style="border: 1px solid rgba(141, 141, 141, 0.452);border-radius: 5px; margin-right: 6px;">
                                YTD
                            </button>
                            <button
                                style="border: 1px solid rgba(141, 141, 141, 0.452);border-radius: 5px; margin-right: 2px;"
                                (click)="clearAllDetails();">
                                <i class="fa fa-refresh"></i>
                            </button>
                            <button *ngIf="imdsearched"
                                style="border: none;background-color: #ffffff00; margin-right: 2px;"
                                (click)="openModalDownload(downloadScoreCardBox,imdInfo.INTERMEDIARY_ID,1)"
                                title="download score card">
                                <i class="fa fa-download"></i>
                            </button>
                        </div>

                        <div style="  padding:1%; cursor: pointer; ">
                        </div>
                    </div>


                    <hr class="solid">

                    <div class="row" style="font-weight: bold; font-size: 17px;">
                        <div class="col-10" style="text-align: left;">
                            <img width="30px;" src="assets/image/user.png" alt="">
                            &nbsp;&nbsp;
                            &nbsp;
                            <span> Agent Info</span>
                        </div>
                        <div class="col-2" [ngClass]="filter_btn_clicked!=0? 'agentInfoGap' : ''">

                            <span *ngIf="month_selectedItems.length!=0" style="font-size: 12px;">{{monthName}}</span>
                        </div>

                    </div>

                    <br>

                    <div class="row" style="    text-align: left; font-size:13px;">

                        <div class="col-3 agentInfoGap">Imd Code</div>
                        <div class="col-3" [ngClass]="imdsearched == true?'agentInfoGapValue':'agentInfoGapValue1'">
                            {{imdInfo.INTERMEDIARY_ID}}</div>

                        <div class="col-3 agentInfoGap">Bucket</div>
                        <div class="col-3" [ngClass]="imdsearched == true?'agentInfoGapValue':'agentInfoGapValue1'">
                            {{imdInfo.BANDING}}</div>

                        <div class="col-3 agentInfoGap">Imd Name</div>
                        <div class="col-3" [ngClass]="imdsearched == true?'agentInfoGapValue':'agentInfoGapValue1'">
                            {{imdInfo.INTERMEDIARY_NAME}}</div>

                        <div class="col-3 agentInfoGap">Vintage</div>
                        <div class="col-3" [ngClass]="imdsearched == true?'agentInfoGapValue':'agentInfoGapValue1'">
                            {{imdInfo.AGENT_VINTAGE}}</div>

                        <div class="col-3 agentInfoGap">Location</div>
                        <div class="col-3" [ngClass]="imdsearched == true?'agentInfoGapValue':'agentInfoGapValue1'">
                            {{imdInfo.LOCATION}}</div>

                        <div class="col-3 agentInfoGap">Background</div>
                        <div class="col-3" [ngClass]="imdsearched == true?'agentInfoGapValue':'agentInfoGapValue1'">
                            {{imdInfo.AGENT_BACKGROUND}}</div>

                        <div class="col-3 agentInfoGap">Gender</div>
                        <div class="col-3" [ngClass]="imdsearched == true?'agentInfoGapValue':'agentInfoGapValue1'">
                            {{imdInfo.GENDER}}</div>

                        <div class="col-3 agentInfoGap">Marital Status</div>
                        <div class="col-3" [ngClass]="imdsearched == true?'agentInfoGapValue':'agentInfoGapValue1'">
                            {{imdInfo.MARRIED_STATUS}}</div>


                        <div class="col-3 agentInfoGap">Agent Age</div>
                        <div class="col-3" [ngClass]="imdsearched == true?'agentInfoGapValue':'agentInfoGapValue1'">
                            {{imdInfo.AGENT_AGE}}</div>

                    </div>

                    <hr class="solid">

                    <div class="row">

                        <div class="details">Bucket </div>
                        &nbsp;
                        <div class="detailsValue"><span style="font-weight: bold;">{{imdInfo.BANDING}}</span> </div>
                        &nbsp;
                        <div class="details">Score </div>
                        &nbsp;
                        <div class="detailsValue"><span style="font-weight: bold;">{{imdInfo.TOTAL}}</span> </div>

                        &nbsp;
                        <div class="details"> CAQ </div>
                        &nbsp;
                        <div class="detailsValue" [style]="style_var_comm">{{imdInfo.COMMISSION_RATIO}} %</div>
                        &nbsp;
                        <div class="details"> LR </div>
                        &nbsp;
                        <div class="detailsValue" [style]="style_var_loss"> {{imdInfo.LOSS_RATIO}} %</div>
                        &nbsp;
                        <div class="details">COR</div>
                        &nbsp;
                        <div class="detailsValue"> {{imdInfo.CY_COR}} %</div>


                        <div style="padding:1%; cursor: pointer; " *ngIf="imdsearched">
                            <mat-icon title="Get CYLY View"
                                (click)="openModal(totalBox,1); getTotalGraph(imdInfo.INTERMEDIARY_ID);">launch</mat-icon>
                        </div>
                    </div>
                    <br>

                    <div class="row">
                        <table class="table table-hover" style="text-align: center; justify-items: center;">


                            <thead>
                                <tr style="background: #535353; color:white ; font-size: 17px; font-weight: bold;">

                                    <th class="tableColumnStyle" style="padding: 0; ">Metrics</th>
                                    <th class="tableColumnStyle" style="padding: 0; ">Actuals</th>
                                    <th class="tableColumnStyle" style="padding: 0; ">Score</th>
                                    <th class="tableColumnStyle" style="padding: 0; ">Max</th>


                                    <th class="tableColumnStyle" style="padding: 0;"></th>



                                </tr>

                            </thead>

                            <tbody *ngIf="imdsearched">
                                <tr class='highlighRow' style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold; ">GWP</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{getComma(scorecardDetails.GWP)}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.MOM_GWP_SCORE}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.MOM_GWP_SCORE}}</td>
                                    <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(gwpBox,1); getGWPScoreDetails(imdInfo.INTERMEDIARY_ID);this.getGWPGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                                    </td>


                                </tr>

                                <tr style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">NOP</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{getComma(scorecardDetails.NOP)}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{scorecardDetails.NOP_FINAL_SCORE}}</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.NOP_FINAL_SCORE}}
                                    </td>

                                    <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(nopBox,1);getNOPScoreDetails(imdInfo.INTERMEDIARY_ID);this.getNOPGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                                    </td>

                                </tr>

                                <tr class='highlighRow' style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">NOP RR%</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.RENEWAL_RATIO}}
                                        %
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.NOP_RR_SCORE}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.NOP_RR_SCORE}}</td>

                                    <td class="tableColumnStyle" style="width:5%; padding: 0;">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(noprrBox,1);getNOPRRScoreDetails(imdInfo.INTERMEDIARY_ID);this.getNOPRRGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                                    </td>

                                </tr>


                                <tr style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">CROSS SELL</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{getComma(scorecardDetails.CROSS_SELL_POL)}}</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{scorecardDetails.CROSS_SELL_SCORE}}</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.CROSS_SELL_SCORE}}
                                    </td>

                                    <td class="tableColumnStyle" style="width:5%; padding: 0;">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(csellBox,1);getSELLScoreDetails(imdInfo.INTERMEDIARY_ID, 'cross sell');getSELLGraphs(imdInfo.INTERMEDIARY_ID, 'cross sell');">open_with</mat-icon>
                                    </td>

                                </tr>


                                <tr class='highlighRow' style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">UPSELL</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{getComma(scorecardDetails.UP_SELL_POL)}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.UP_SELL_SCORE}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.UP_SELL_SCORE}}</td>

                                    <td class="tableColumnStyle" style="width:5%; padding: 0;">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(upsellBox,1);getSELLScoreDetails(imdInfo.INTERMEDIARY_ID, 'upsell');getSELLGraphs(imdInfo.INTERMEDIARY_ID, 'upsell');">open_with</mat-icon>
                                    </td>

                                </tr>

                                <tr style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">WINBACK</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{getComma(scorecardDetails.WINBACK_POL)}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.WINBACK_SCORE}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.WINBACK_SCORE}}</td>

                                    <td class="tableColumnStyle" style="width:5%; padding: 0;">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(winbackBox,1);getSELLScoreDetails(imdInfo.INTERMEDIARY_ID, 'winback');getSELLGraphs(imdInfo.INTERMEDIARY_ID, 'winback');">open_with</mat-icon>
                                    </td>

                                </tr>

                                <tr class='highlighRow' style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">DIGITAL TP</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{scorecardDetails.DIGITAL_ACTIVENESS}} %</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.DTP_SCORE}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.DTP_SCORE}}</td>

                                    <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(digitalBox,1);getDTPScoreDetails(imdInfo.INTERMEDIARY_ID);getDTPGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                                    </td>

                                </tr>

                                <tr style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">PHYSICAL TP</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{getComma(scorecardDetails.MEETING_COUNT)}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.PTP_SCORE}}
                                    </td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.PTP_SCORE}}</td>

                                    <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(physicalBox,1);getPTPScoreDetails(imdInfo.INTERMEDIARY_ID);this.getPTPGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                                    </td>

                                </tr>

                                <tr class='highlighRow' style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">CAMPAIGN E</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{scorecardDetails.CY_ELIGIBILITY_PER}} %</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{scorecardDetails.CAMPAIGN_SCORE}}</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.CAMPAIGN_SCORE}}
                                    </td>

                                    <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(campaignBox,1);getCampaignScoreDetails(imdInfo.INTERMEDIARY_ID); this.getCampaignGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                                    </td>

                                </tr>

                                <tr style="padding: 0;">
                                    <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">LOB</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.LOB}}</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">
                                        {{scorecardDetails.LOB_MAIN_SCORE}}</td>
                                    <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.LOB_MAIN_SCORE}}
                                    </td>

                                    <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                                        <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                            (click)="openModal(lobBox,1);getLOBScoreDetails(imdInfo.INTERMEDIARY_ID); this.getLOBGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                                    </td>

                                </tr>

                            </tbody>
                        </table>
                    </div>
                    <div class="row" style="font-weight: bold; font-size: 17px;" *ngIf="imdsearched">
                        <div class="col-12" style="justify-content: center; text-align: center;">
                            <img width="30px;" src="assets/image/graphrecommendation.png" alt="">
                            &nbsp;&nbsp;&nbsp;
                            <span> Recommendation Towards Growth</span>
                        </div>
                        <br>
                        <div class="row" style="background-color: rgb(235 251 255);
                            border: solid 1px rgb(0 188 211); padding: 4% !important;
                            height: 250px;overflow: scroll; border-radius: 8px;
                            margin-top: 15px !important; font-size: 15px; text-align: left;">
                            <span> &#9658; &nbsp;</span>Agent scored &nbsp;<span> {{imdInfo.TOTAL}} &nbsp; </span> and
                            closed <span>
                                &nbsp;{{imdInfo.monthStr}} &nbsp;</span> in band '<span>{{imdInfo.BANDING}}'.</span>
                            <br>


                            <span> &#9658; &nbsp;Agent has <span>{{imdInfo.GROWTH}}</span> its performance from <span>
                                    &nbsp;{{imdInfo.lastm_monthStr}} &nbsp;</span> (BAND
                                <span>&nbsp;'{{imdInfo.LASTM_BANDING}}'&nbsp;</span>) to <span>
                                    &nbsp;{{imdInfo.monthStr}}
                                    &nbsp;</span> (BAND <span>&nbsp;'{{imdInfo.BANDING}}'&nbsp;</span>) .</span>
                            <br>

                            <ng-container *ngFor="let eachrec of recommendationList">

                                <span> &#9658; &nbsp; {{eachrec}}</span>
                                <br>
                            </ng-container>
                        </div>

                    </div>
                    <br>

                    <div class="row" style="font-weight: bold; font-size: 17px;" *ngIf="imdsearched">
                        <div class="col-12" style="justify-content: center; text-align: center;">
                            <span> Total Score</span>
                        </div>
                        <div class="col-12" style="padding:2%">
                            <canvas id="totalChart_rep"></canvas>
                        </div>
                    </div>
                    <div class="row" style="font-weight: bold; font-size: 17px; margin-top: 10px;" *ngIf="imdsearched">
                        <div class="col-12" style="justify-content: center; text-align: center;">
                            <span> LR Vs CAQ Vs COR</span>
                        </div>
                        <div class="col-12" style="padding:2%">
                            <canvas id="lrVsCaqGraph"></canvas>
                        </div>
                    </div>
                    <div class="row" style="font-weight: bold; font-size: 17px; margin-top: 10px;" *ngIf="imdsearched">
                        <div class="col-12" style="justify-content: center; text-align: center;">
                            <span>LOB Wise GWP</span>
                        </div>
                        <div class="col-12" style="padding:2%">
                            <canvas id="lobPieGraph"></canvas>
                        </div>
                    </div>





                </div> -->

            </div>


        </div>
    </div>


    
</ng-container>



<!-- -----------loading screen----------- -->
<div *ngIf="loadingStatus" class="loading"
    style="z-index: 1; width: 100%; height:100%; background-color: rgba(0, 0, 0, 0.589); position: fixed; top:0%; left: 0%;">
    <div class="text-center" style="padding-top: 22%; display: flex; justify-content: center; align-items: center;">
        <!-- <mat-spinner   color="cyan"></mat-spinner> -->
        <div class="spinner-border text-light" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
</div>



<ng-template #agentScoreBox>


    <div style="padding:30px!important;">
        <div class="row" style="text-align: center;">
            <span style="font-weight: bold; font-size: 18pt;">
                Agent Score Card
            </span>
            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="closeModal()" style="cursor: pointer;">close</mat-icon>

            </span>
        </div>

        <hr class="solid">

        <div class="row" style="font-weight: bold; font-size: 17px;">
            <img width="30px;" src="assets/image/user.png" alt="">
            &nbsp;&nbsp;
            &nbsp;

            <span style="position: relative; top: 3px;"> Agent Info</span>



        </div>

        <br>

        <div class="row" style="    text-align: left; font-size:13px;
                     ">

            <!-- <div class="col-3" style="background-color: rgb(161, 159, 159);">Imd Code</div>
                       &nbsp;
                       <div class="col-2" style="background-color:  rgb(241, 240, 240);">3423456</div>
                       &nbsp;
                       <div class="col-3" style="background-color: rgb(161, 159, 159);">Bucket</div>
                       &nbsp;
                       <div class="col-2" style="background-color:  rgb(241, 240, 240);" >B</div> -->
            <div class="col-2" style="font-weight: bold; text-align: left;   background-color:  rgb(241, 240, 240);">Imd
                Code</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.INTERMEDIARY_ID}}</div>

            <div class="col-3" style="font-weight: bold; text-align: left;  background-color:  rgb(241, 240, 240);">
                Bucket</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.BANDING}}</div>

            <div class="col-2" style="font-weight: bold; text-align: left;   background-color:  rgb(241, 240, 240);">
                Gender</div>

            <div class="col-1" style="text-align: left; ">{{imdInfo.GENDER}}</div>

            <div class="col-2" style="font-weight: bold; text-align: left; background-color:  rgb(241, 240, 240);">Imd
                Name</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.INTERMEDIARY_NAME}}</div>

            <div class="col-3" style="font-weight: bold; text-align: left;  background-color:  rgb(241, 240, 240);">
                Background</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.AGENT_BACKGROUND}}</div>

            <div class="col-2" style="font-weight: bold; text-align: left; background-color:  rgb(241, 240, 240);">
                Marital Status</div>

            <div class="col-1" style="text-align: left; ">{{imdInfo.MARRIED_STATUS}}</div>


            <div class="col-2" style="font-weight: bold; text-align: left; background-color: rgb(241, 240, 240);">
                Location</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.LOCATION}}</div>

            <div class="col-3" style="font-weight: bold; text-align: left;  background-color:  rgb(241, 240, 240);">
                Vintage</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.AGENT_VINTAGE}}</div>

            <div class="col-2" style="font-weight: bold; text-align: left; background-color:  rgb(241, 240, 240);">Agent
                Age</div>

            <div class="col-1" style="text-align: left; ">{{imdInfo.AGENT_AGE}}</div>

        </div>

        <hr class="solid">

        <div class="row" style="font-weight: bold; font-size: 17px;">
            <img width="40px;" src="assets/image/scorecard.png" alt="">
            &nbsp;&nbsp;
            &nbsp;

            <span style="position: relative; top: 3px;"> Agent Score Card</span>


            &nbsp;
            &nbsp;
            &nbsp;
            &nbsp;
            &nbsp;
            &nbsp;
            &nbsp;

            <!-- <div style="position: absolute; right:0;">  -->

            <div style=" padding:1% ;background-color: rgb(241, 240, 240);">Bucket </div>
            &nbsp; &nbsp;
            <div style=" padding:1% ;background-color: rgb(147, 168, 113);"><span
                    style="font-weight: bold;">{{imdInfo.BANDING}}</span> </div>



            &nbsp;
            &nbsp;
            &nbsp;
            &nbsp;


            <div style="padding:1% ;background-color: rgb(241, 240, 240);">Score </div>
            &nbsp; &nbsp;

            <div style="  padding:1%; background-color: rgb(147, 168, 113);"><span
                    style="font-weight: bold;">{{imdInfo.TOTAL}}</span> </div>

            &nbsp;
            &nbsp;

            <div style="  padding:1%; cursor: pointer; ">
                <mat-icon title="download score card"
                    (click)="openModalDownload(downloadScoreCardBox,imdInfo.INTERMEDIARY_ID,0)">get_app</mat-icon>
                &nbsp;&nbsp;
                <mat-icon title="Get CYLY View"
                    (click)="openModal(totalBox,0); getTotalGraph(imdInfo.INTERMEDIARY_ID);">launch</mat-icon>

            </div>





            <!-- </div> -->

        </div>
        <br>

        <div class="row">
            <table class="table table-hover" style="text-align: center; justify-items: center;">


                <thead>
                    <tr class="" style="background: #535353; color:white ; font-size: 17px; font-weight: bold;">

                        <th class="tableColumnStyle" style="padding: 0; ">Metrics</th>
                        <th class="tableColumnStyle" style="padding: 0; ">Actuals</th>
                        <th class="tableColumnStyle" style="padding: 0; ">Score</th>
                        <th class="tableColumnStyle" style="padding: 0; ">Max</th>


                        <th class="tableColumnStyle" style="padding: 0;"></th>



                    </tr>

                </thead>

                <tbody>
                    <!-- <ng-container *ngFor="let rowline of scorecardDetails; let i=index;" > -->
                    <tr class='highlighRow' style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">GWP</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.GWP}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.MOM_GWP_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.MOM_GWP_SCORE}}</td>
                        <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;" (click)="closeModal(); openModal(gwpBox,0); getGWPScoreDetails(imdInfo.INTERMEDIARY_ID);     this.getGWPGraphs(imdInfo.INTERMEDIARY_ID);
">open_with</mat-icon>
                        </td>


                    </tr>

                    <tr style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">NOP</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.NOP}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.NOP_FINAL_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.NOP_FINAL_SCORE}}</td>

                        <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="closeModal();openModal(nopBox,0);getNOPScoreDetails(imdInfo.INTERMEDIARY_ID); getNOPGraphs(imdInfo.INTERMEDIARY_ID)">open_with</mat-icon>
                        </td>

                    </tr>

                    <tr class='highlighRow' style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">NOP RR%</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.RENEWAL_RATIO}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.NOP_RR_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.NOP_RR_SCORE}}</td>

                        <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="closeModal();openModal(noprrBox,0);getNOPRRScoreDetails(imdInfo.INTERMEDIARY_ID);this.getNOPRRGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                        </td>

                    </tr>

                    <tr style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">CROSS SELL</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.CROSS_SELL_POL}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.CROSS_SELL_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.CROSS_SELL_SCORE}}</td>

                        <td class="tableColumnStyle" style="width:5%; padding: 0;">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="openModal(csellBox,0);getSELLScoreDetails(imdInfo.INTERMEDIARY_ID, 'cross sell');getSELLGraphs(imdInfo.INTERMEDIARY_ID, 'cross sell');">open_with</mat-icon>
                        </td>

                    </tr>


                    <tr class='highlighRow' style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">UPSELL</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.UP_SELL_POL}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.UP_SELL_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.UP_SELL_SCORE}}</td>

                        <td class="tableColumnStyle" style="width:5%; padding: 0;">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="openModal(upsellBox,0);getSELLScoreDetails(imdInfo.INTERMEDIARY_ID, 'upsell');getSELLGraphs(imdInfo.INTERMEDIARY_ID, 'upsell');">open_with</mat-icon>
                        </td>

                    </tr>

                    <tr style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">WINBACK</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.WINBACK_POL}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.WINBACK_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.WINBACK_SCORE}}</td>

                        <td class="tableColumnStyle" style="width:5%; padding: 0;">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="openModal(winbackBox,0);getSELLScoreDetails(imdInfo.INTERMEDIARY_ID, 'winback');getSELLGraphs(imdInfo.INTERMEDIARY_ID, 'winback');">open_with</mat-icon>
                        </td>

                    </tr>

                    <!-- <tr class='highlighRow' style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">COR</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.CY_COR}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.PROFITABILITY_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.PROFITABILITY_SCORE}}</td>

                        <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="closeModal();openModal(corBox,0);
                                                        getCORScoreDetails(imdInfo.INTERMEDIARY_ID);this.getCORGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                        </td>
                    </tr> -->

                    <tr class='highlighRow' style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">DIGITAL TP</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.DIGITAL_ACTIVENESS}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.DTP_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.DTP_SCORE}}</td>
                        <!-- <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.actual}}</td>
                                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.score}}</td>
                                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.max}}</td> -->

                        <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="closeModal();openModal(digitalBox,0);getDTPScoreDetails(imdInfo.INTERMEDIARY_ID); getDTPGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                        </td>

                    </tr>

                    <tr style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0;font-weight: bold; ">PHYSICAL TP</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.MEETING_COUNT}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.PTP_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.PTP_SCORE}}</td>

                        <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="closeModal();openModal(physicalBox,0);getPTPScoreDetails(imdInfo.INTERMEDIARY_ID); getPTPGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                        </td>

                    </tr>

                    <tr class='highlighRow' style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0;font-weight: bold; ">CAMPAIGN E</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.CY_ELIGIBILITY_PER}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.CAMPAIGN_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.CAMPAIGN_SCORE}}</td>

                        <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="closeModal();openModal(campaignBox,0);
                                                        getCampaignScoreDetails(imdInfo.INTERMEDIARY_ID);this.getCampaignGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                        </td>

                    </tr>

                    <tr style="padding: 0;">
                        <td class="tableColumnStyle" style="padding: 0; font-weight: bold;">LOB</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.LOB}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scorecardDetails.LOB_MAIN_SCORE}}</td>
                        <td class="tableColumnStyle" style="padding: 0; ">{{scoreConfig.LOB_MAIN_SCORE}}</td>

                        <td class="tableColumnStyle" style="width:5%; padding: 0; ">
                            <mat-icon style="font-size: 12pt;
                                                        
                                                        position: relative;
                                                        top: 4px; color:rgb(105, 104, 104); cursor: pointer;"
                                (click)="closeModal();openModal(lobBox,0);
                                                        getLOBScoreDetails(imdInfo.INTERMEDIARY_ID);this.getLOBGraphs(imdInfo.INTERMEDIARY_ID);">open_with</mat-icon>
                        </td>

                    </tr>









                    <!-- </ng-container>                   -->

                </tbody>
            </table>
        </div>

    </div>


</ng-template>



<ng-template #agentRecommendationBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <span style="font-weight: bold; font-size: 18pt;"> Agent Score Card</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="closeModal()" style="cursor: pointer;">close</mat-icon>

            </span>

        </div>

        <hr class="solid">


        <div class="row" style="font-weight: bold; font-size: 17px;">
            <img width="30px;" src="assets/image/user.png" alt="">
            &nbsp;&nbsp;
            &nbsp;

            <span style="position: relative; top: 3px;"> Agent Info</span>



        </div>

        <br>

        <div class="row" style="    text-align: left; font-size:13px;
             ">

            <!-- <div class="col-3" style="background-color: rgb(161, 159, 159);">Imd Code</div>
               &nbsp;
               <div class="col-2" style="background-color:  rgb(241, 240, 240);">3423456</div>
               &nbsp;
               <div class="col-3" style="background-color: rgb(161, 159, 159);">Bucket</div>
               &nbsp;
               <div class="col-2" style="background-color:  rgb(241, 240, 240);" >B</div> -->
            <div class="col-2" style="font-weight: bold; text-align: left;   background-color:  rgb(241, 240, 240);">Imd
                Code</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.INTERMEDIARY_ID}}</div>

            <div class="col-3" style="font-weight: bold; text-align: left;  background-color:  rgb(241, 240, 240);">
                Bucket</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.BANDING}}</div>

            <div class="col-2" style="font-weight: bold; text-align: left;   background-color:  rgb(241, 240, 240);">
                Gender</div>

            <div class="col-1" style="text-align: left; ">{{imdInfo.GENDER}}</div>

            <div class="col-2" style="font-weight: bold; text-align: left; background-color:  rgb(241, 240, 240);">Imd
                Name</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.INTERMEDIARY_NAME}}</div>

            <div class="col-3" style="font-weight: bold; text-align: left;  background-color:  rgb(241, 240, 240);">
                Background</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.AGENT_BACKGROUND}}</div>

            <div class="col-2" style="font-weight: bold; text-align: left; background-color:  rgb(241, 240, 240);">
                Marital Status</div>

            <div class="col-1" style="text-align: left; ">{{imdInfo.MARRIED_STATUS}}</div>


            <div class="col-2" style="font-weight: bold; text-align: left; background-color: rgb(241, 240, 240);">
                Location</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.LOCATION}}</div>

            <div class="col-3" style="font-weight: bold; text-align: left;  background-color:  rgb(241, 240, 240);">
                Vintage</div>

            <div class="col-2" style="text-align: left; ">{{imdInfo.AGENT_VINTAGE}}</div>

            <div class="col-2" style="font-weight: bold; text-align: left; background-color:  rgb(241, 240, 240);">Agent
                Age</div>

            <div class="col-1" style="text-align: left; ">{{imdInfo.AGENT_AGE}}</div>

        </div>

        <hr class="solid">

        <div class="row" style="font-weight: bold; font-size: 17px;">
            <img width="30px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp;&nbsp;
            &nbsp;

            <span style="position: relative; top: 3px;"> Recommendation Towards Growth</span>

            <br>
            <div class="row" style="background-color: rgb(235 251 255);
                border: solid 1px rgb(0 188 211);
                padding: 4% !important;
                height: 250px;overflow: scroll;
                margin-top: 15px !important; font-size: 15px;">
                <span> &#9658; &nbsp;</span>Agent scored &nbsp;<span> {{imdInfo.TOTAL}} &nbsp; </span> and closed <span>
                    &nbsp;{{imdInfo.monthStr}} &nbsp;</span> in band '<span>{{imdInfo.BANDING}}'.</span>
                <br>


                <span> &#9658; &nbsp;Agent has <span>{{imdInfo.GROWTH}}</span> its performance from <span>
                        &nbsp;{{imdInfo.lastm_monthStr}} &nbsp;</span> (BAND
                    <span>&nbsp;'{{imdInfo.LASTM_BANDING}}'&nbsp;</span>) to <span> &nbsp;{{imdInfo.monthStr}}
                        &nbsp;</span> (BAND <span>&nbsp;'{{imdInfo.BANDING}}'&nbsp;</span>) .</span>
                <br>

                <ng-container *ngFor="let eachrec of recommendationList">

                    <span> &#9658; &nbsp; {{eachrec}}</span>
                    <br>
                </ng-container>


            </div>

        </div>

    </div>


</ng-template>



<ng-template #totalBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> Total Score</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack(agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-12" style="padding:2%">
                <canvas id="totalChart" width="1500" height="1000"></canvas>

                <br>

                <!-- <canvas  id="bandingChart" width="1500" height="1000"></canvas> -->


            </div>



        </div>

    </div>


</ng-template>


<ng-template #gwpBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> GWP</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-5" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">CM GWP</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scorecardDetails.GWP}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scorecardDetails.GWP_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scoreConfig.GWP_SCORE}}</td>



                        </tr>

                        <tr class="highlighRow" style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">CM GROWTH</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scorecardDetails.MOM_GROWTH}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scorecardDetails.MOM_GROWTH_SCORE}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scoreConfig.MOM_GROWTH_SCORE}}</td>



                        </tr>

                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">CMLY GROWTH</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scorecardDetails.CMLY_GROWTH}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scorecardDetails.CMLY_GROWTH_SCORE}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scoreConfig.CMLY_GROWTH_SCORE}}</td>



                        </tr>

                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">CMLY GROWTH ABSOLUTE</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{gwp_scorecardDetails.CMLY_GROWTH_ABSOLUTE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{gwp_scorecardDetails.CMLY_GROWTH_ABSOLUTE_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{gwp_scoreConfig.CMLY_GROWTH_ABSOLUTE_SCORE}}</td>



                        </tr>

                        <tr class="highlighRow" style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">CONSISTENCY</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scorecardDetails.CONSISTENCY}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scorecardDetails.CONSISTENCY_SCORE}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{gwp_scoreConfig.CONSISTENCY_SCORE}}</td>


                        </tr>











                    </tbody>
                </table>
            </div>

            <div class="col-7">
                <!-- <div class="chart-container"> -->
                <div class="col-12">
                    Total:
                    <!-- <button (click)="exportChart();">Export</button> -->
                    <canvas id="gwpChart1" width="1000" height="1000"></canvas>
                </div>
                <br>
                <div class="col-12" style="margin-top:  3px !important;">
                    Bifurcation:
                    <canvas id="gwpChart2" width="1500" height="1000"></canvas>
                </div>



                <!-- <canvas  id="MyChart" width="500" height="500">{{ chart }}</canvas> -->
                <!-- </div>  -->
                <!-- <canvas id="myChart" width="100" height="100">{{chart}}</canvas> -->

            </div>

        </div>

    </div>


</ng-template>



<ng-template #nopBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> NOP</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-5" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">NB NOP</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{nop_scorecardDetails.NOP}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{nop_scorecardDetails.NOP_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{nop_scoreConfig.NOP_SCORE}}</td>



                        </tr>

                        <tr class="highlighRow" style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">REN NOP</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{nop_scorecardDetails.RENWED_COUNT}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{nop_scorecardDetails.RENWED_COUNT_SCORE}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{nop_scoreConfig.RENWED_COUNT_SCORE}}</td>


                        </tr>





                    </tbody>
                </table>
            </div>

            <!-- <div class="col-6"> -->
            <div class="col-7">
                <!-- <div class="chart-container"> -->
                <div class="col-12">
                    Total:
                    <canvas id="nopChart1" width="1000" height="1000"></canvas>
                </div>
                <br>
                <div class="col-12" style="margin-top:  3px !important;">
                    Bifurcation:
                    <canvas id="nopChart2" width="1500" height="1000"></canvas>
                </div>



                <!-- <canvas  id="MyChart" width="500" height="500">{{ chart }}</canvas> -->
                <!-- </div>  -->
                <!-- <canvas id="myChart" width="100" height="100">{{chart}}</canvas> -->

            </div>
            <!-- </div> -->

        </div>

    </div>


</ng-template>



<ng-template #noprrBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> Renewal Ratio</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-6" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">RR%</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{noprr_scorecardDetails.RENEWAL_RATIO}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{noprr_scorecardDetails.RENEWAL_RATIO_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{noprr_scoreConfig.RENEWAL_RATIO_SCORE}}
                            </td>



                        </tr>







                    </tbody>
                </table>
            </div>

            <div class="col-6">

                <div class="col-12">

                    <canvas id="noprrChart1" width="1000" height="1000"></canvas>
                </div>





            </div>

        </div>

    </div>


</ng-template>



<ng-template #corBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> Profitability</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-5" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">COR CY</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{cor_scorecardDetails.CY_COR}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{cor_scorecardDetails.CY_COR_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{cor_scoreConfig.CY_COR_SCORE}}</td>



                        </tr>

                        <tr class="highlighRow" style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">COR CY/LY</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{cor_scorecardDetails.COR_CY_LY}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{cor_scorecardDetails.COR_CY_LY_SCORE}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{cor_scoreConfig.COR_CY_LY_SCORE}}</td>



                        </tr>





                    </tbody>
                </table>
            </div>

            <div class="col-7">
                <!-- <div class="chart-container"> -->
                <div class="col-12">
                    Total:
                    <canvas id="corChart1" width="1000" height="1000"></canvas>
                </div>
                <br>
                <div class="col-12" style="margin-top:  3px !important;">
                    Bifurcation:
                    <canvas id="corChart2" width="1500" height="1000"></canvas>
                </div>



                <!-- <canvas  id="MyChart" width="500" height="500">{{ chart }}</canvas> -->
                <!-- </div>  -->
                <!-- <canvas id="myChart" width="100" height="100">{{chart}}</canvas> -->

            </div>

        </div>

    </div>


</ng-template>




<ng-template #lobBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> Finance LOB</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-6" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">LOB Type</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{lob_scorecardDetails.LOB}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{lob_scorecardDetails.LOB_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{lob_scoreConfig.LOB_SCORE}}</td>



                        </tr>






                    </tbody>
                </table>
            </div>

            <div class="col-6">
                <div class="col-12">

                    <canvas id="lobChart1" width="1000" height="1000"></canvas>
                </div>
            </div>

        </div>

    </div>


</ng-template>



<ng-template #campaignBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> Campaign</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-6" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">CY Eligibility</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{campaign_scorecardDetails.CY_ELIGIBILITY_PER}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{campaign_scorecardDetails.CY_ELIGIBILITY_PER_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{campaign_scoreConfig.CY_ELIGIBILITY_PER_SCORE}}</td>



                        </tr>

                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">LY Eligibility</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{campaign_scorecardDetails.LY_ELIGIBILITY_PER}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{campaign_scorecardDetails.LY_ELIGIBILITY_PER_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{campaign_scoreConfig.LY_ELIGIBILITY_PER_SCORE}}</td>



                        </tr>






                    </tbody>
                </table>
            </div>

            <div class="col-6">
                <div class="col-12">
                    Total:
                    <canvas id="cmpChart1" width="1000" height="1000"></canvas>
                </div>
                <br>
                <div class="col-12" style="margin-top:  3px !important;">
                    Bifurcation:
                    <canvas id="cmpChart2" width="1000" height="1000"></canvas>
                </div>
            </div>

        </div>

    </div>


</ng-template>



<ng-template #digitalBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> Digital Touch Point</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-6" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">Digital Activeness</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{dtp_scorecardDetails.DIGITAL_ACTIVENESS}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{dtp_scorecardDetails.DTP_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{dtp_scoreConfig.DIGITAL_ACTIVENESS_SCORE}}</td>



                        </tr>






                    </tbody>
                </table>
            </div>

            <div class="col-6">
                <div class="col-12">

                    <canvas id="dtpChart1" width="1000" height="1000"></canvas>
                </div>
            </div>

        </div>

    </div>


</ng-template>



<ng-template #physicalBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> Physical Touch
                Point</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-6" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">Meeting Count</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{ptp_scorecardDetails.MEETING_COUNT}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">
                                {{ptp_scorecardDetails.MEETING_COUNT_SCORE}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{ptp_scoreConfig.MEETING_COUNT_SCORE}}
                            </td>



                        </tr>






                    </tbody>
                </table>
            </div>

            <div class="col-6">
                <div class="col-12">

                    <canvas id="ptpChart1" width="1000" height="1000"></canvas>
                </div>
            </div>

        </div>

    </div>


</ng-template>



<ng-template #csellBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> CROSS SELL</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-6" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">Cross Sell Policy</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{sale_scorecardDetails.CROSS_SELL_POL}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{sale_scorecardDetails.CROSS_SELL_SCORE}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{sale_scoreConfig.CROSS_SELL_POL_SCORE}}
                            </td>



                        </tr>






                    </tbody>
                </table>
            </div>

            <div class="col-6">
                <div class="col-12">

                    <canvas id="sellChart1" width="1000" height="1000"></canvas>
                </div>
            </div>

        </div>

    </div>


</ng-template>


<ng-template #upsellBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> UPSELL</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-6" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">Upsell Policy</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{sale_scorecardDetails.UP_SELL_POL}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{sale_scorecardDetails.UP_SELL_SCORE}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{sale_scoreConfig.UP_SELL_POL_SCORE}}</td>



                        </tr>






                    </tbody>
                </table>
            </div>

            <div class="col-6">
                <div class="col-12">

                    <canvas id="sellChart1" width="1000" height="1000"></canvas>
                </div>
            </div>

        </div>

    </div>


</ng-template>

<ng-template #winbackBox>


    <div style="padding:30px!important;">

        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;

            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> WINBACK</span>

            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack( agentScoreBox)" style="cursor: pointer;">arrow_back</mat-icon>

            </span>

        </div>

        <hr class="solid">





        <div class="row" style="font-weight: bold; font-size: 17px;">

            <div class="col-6" style="padding:2%">
                <table class="table table-hover" style="text-align: center; justify-items: center;">


                    <thead>
                        <tr class="" style="background: #bbd4e9;">
                            <th class="tableColumnStyle" style="padding: 0;">Bifurcation</th>
                            <th class="tableColumnStyle" style="padding: 0;">Actual</th>
                            <th class="tableColumnStyle" style="padding: 0;">Score</th>
                            <th class="tableColumnStyle" style="padding: 0;">Max</th>


                        </tr>

                    </thead>

                    <tbody>
                        <tr style="padding: 0;">
                            <td style="padding: 0;" class="tableColumnStyle">Winback Policy</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{sale_scorecardDetails.WINBACK_POL}}</td>
                            <td style="padding: 0;" class="tableColumnStyle">{{sale_scorecardDetails.WINBACK_SCORE}}
                            </td>
                            <td style="padding: 0;" class="tableColumnStyle">{{sale_scoreConfig.WINBACK_POL_SCORE}}</td>



                        </tr>






                    </tbody>
                </table>
            </div>

            <div class="col-6">
                <div class="col-12">

                    <canvas id="sellChart1" width="1000" height="1000"></canvas>
                </div>
            </div>

        </div>

    </div>


</ng-template>


<ng-template #downloadScoreCardBox>


    <div style="padding:30px!important;">
        <div class="row" style="text-align: center;">
            <span style="font-weight: bold; font-size: 18pt;">
                Score Card Download
            </span>
            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="goBack(agentScoreBox)" style="cursor: pointer;">close</mat-icon>

            </span>
        </div>

        <hr class="solid">
        <div class="row" style="font-weight: bold; font-size: 17px; ">

            Choose Format for downloading the Agent Score Card.
        </div>
        <br>
        <br>
        <div class="row" style="font-weight: bold; font-size: 17px; ">


            <!-- <br> -->
            <div class="col-6" style="padding:0 !important;">
                <button class="filterApplyButton" style="    background-color: rgb(0 74 139);
                height: 42px;" (click)="downloadScoreCard()">
                    <span>.xlsx</span>
                </button>
            </div>
            <div class="col-6" style="padding:0 !important;">
                <button class="filterApplyButton" style="    background-color: rgb(0 74 139);
                height: 42px;" (click)="downloadScoreCardPDF()">
                    <!-- <span>.pdf</span> -->
                    <span>.docx</span>
                </button>
            </div>


            <!-- <div style="padding:2% !important">Month Year</div>

            &nbsp;
            &nbsp;

            <div style="padding:2% !important; font-weight: lighter;">
            
                <div  class="multiselectFilter">
                    <ng-multiselect-dropdown
                        [placeholder]="'MONTH YEAR'"
                        [settings]="month_dropdownSettings"
                        [data]="month_dropdownList"
                        [(ngModel)]="month_selectedItems"
                        >
                    </ng-multiselect-dropdown>
                </div>
            </div> -->





        </div>

        <!-- <br> -->


        <!-- <hr class="solid"> -->



    </div>


</ng-template>


<!-- <ng-container   *ngIf="apiComPlitionCount < 1"> -->
<ng-container   *ngIf="apiComPlitionCount == 1000000000">
    <div class="row" style="height: 100vh; width: 100%; background: linear-gradient(to right, rgba(255, 255, 255, 0.349) 205px, rgb(255, 255, 255) 0); position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 20px;
    z-index: 1; overflow: hidden; display: flex; align-items: center; justify-content: center;">



        <!-- <div style="display: flex; align-items: center;">
            <div class="spinner-grow text-primary" role="status">
                <span class="sr-only">Loading...</span>
            </div>

            <div class="spinner-grow text-primary" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div> -->


        <!-- <div class="lds-hourglass"></div> -->

        <div style="display: flex; align-items: center; padding-left: 102px;">
            <span style=" color: #006fd6cb; font-size: 16px; font-weight: 550;">L</span> &nbsp;

            <div class="lds-default"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>

            &nbsp;
            <span style=" color: #006fd6cb; font-size: 16px; font-weight: 550;">ading</span> &nbsp;
        </div>
        
        
        
        
    </div>
</ng-container>



<!-- <div id="loading-screen">
    <div class="spinner"></div>
    <p>Loading...</p>
  </div> -->



















  <ng-template #showBandTrendGraph let-modal>

    

        <div style="padding:30px!important; background-color: #f8f8f8;">
        
            <div class="row" style="text-align: center;">
                <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
                &nbsp; &nbsp;
        
                <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;"> Band Trend Graphical Presentation</span>
        
                <span style="position: absolute; right: 33px;">
                    <mat-icon (click)="closeModal1('showBandTrendGraph')" style="cursor: pointer;">arrow_back</mat-icon>
        
                </span>
        
            </div>

            
        
        
        
        
        
            <div class="row" style="font-weight: bold; font-size: 17px;margin-top: 30px!important;">
        
                <div class="col-12" style="padding:2%; border: 1px solid rgba(109, 109, 109, 0.829); border-radius: 10px; background-color: #ffffff;">
                    <div id="bandComparison" style="width: 95%; height: 100%;"></div>
                </div>

                
        
        
        
                
        
                
        
            </div>

            <div class="row" style="margin-top: 20px!important;">

                <div class="col cyly">
                    <div class="" style="font-weight: 900; font-size: 16px!important;">CY-LY Graph</div>
                </div>

                <div class="col">
                    <button class="bndbtn" (click)="openModal1('cylyGraph', cylyGraph);cylyGraphMakingOnly('A+')">A+</button>
                </div>

                <div class="col">
                    <button class="bndbtn" (click)="openModal1('cylyGraph', cylyGraph);cylyGraphMakingOnly('A')">A</button>
                </div>

                <div class="col">
                    <button class="bndbtn" (click)="openModal1('cylyGraph', cylyGraph);cylyGraphMakingOnly('B')">B</button>
                </div>

                <div class="col">
                    <button class="bndbtn" (click)="openModal1('cylyGraph', cylyGraph);cylyGraphMakingOnly('C')">C</button>
                </div>

                <div class="col">
                    <button class="bndbtn" (click)="openModal1('cylyGraph', cylyGraph);cylyGraphMakingOnly('D')">D</button>
                </div>

                <div class="col">
                    <button class="bndbtn" (click)="openModal1('cylyGraph', cylyGraph);cylyGraphMakingOnly('E')">E</button>
                </div>

            </div>
            
        </div>




</ng-template>




















<ng-template #cylyGraph let-modal>

    

    <div style="padding:30px!important; background-color: #f8f8f8;">
    
        <div class="row" style="text-align: center;">
            <img width="35px;" src="assets/image/graphrecommendation.png" alt="">
            &nbsp; &nbsp;
    
            <span style="font-weight: bold; font-size: 18pt; position: relative; top: 10px;">Band {{cyly_bandName}} CY LY</span>
    
            <span style="position: absolute; right: 33px;">
                <mat-icon (click)="closeModal1('cylyGraph'); cyly_bandName = ''" style="cursor: pointer;">arrow_back</mat-icon>
    
            </span>
    
        </div>

        
    
    
    
    
    
        <div class="row" style="font-weight: bold; font-size: 17px;margin-top: 30px!important;">
    
            <div class="col-12" style="padding:2%; border: 1px solid rgba(109, 109, 109, 0.829); border-radius: 10px; background-color: #ffffff;">
                <div id="cylyComparison" style="width: 95%; height: 100%;"></div>
            </div>         
    
    
    
            
    
            
    
        </div>
        
    </div>




</ng-template>